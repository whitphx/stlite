{"version":3,"file":"index-CE_fnBHU.js","sources":["../../../node_modules/@emotion-icons/material-outlined/AttachFile/AttachFile.esm.js","../../../node_modules/@emotion-icons/material-rounded/Send/Send.esm.js","../../../streamlit/frontend/lib/src/components/widgets/ChatInput/fileUpload/fileUploadUtils.ts","../../../streamlit/frontend/lib/src/components/widgets/ChatInput/fileUpload/styled-components.ts","../../../streamlit/frontend/lib/src/components/widgets/ChatInput/fileUpload/ChatFileUploadButton.tsx","../../../streamlit/frontend/lib/src/components/widgets/ChatInput/fileUpload/ChatFileUploadDropzone.tsx","../../../streamlit/frontend/lib/src/components/widgets/ChatInput/fileUpload/ChatUploadedFileIconTooltip.tsx","../../../streamlit/frontend/lib/src/components/widgets/ChatInput/fileUpload/ChatUploadedFile.tsx","../../../streamlit/frontend/lib/src/components/widgets/ChatInput/fileUpload/ChatUploadedFiles.tsx","../../../streamlit/frontend/lib/src/components/widgets/ChatInput/fileUpload/createDropHandler.ts","../../../streamlit/frontend/lib/src/components/widgets/ChatInput/fileUpload/createFileUploadHandler.ts","../../../streamlit/frontend/lib/src/components/widgets/ChatInput/styled-components.ts","../../../streamlit/frontend/lib/src/components/widgets/ChatInput/ChatInput.tsx"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { EmotionIconBase } from '@emotion-icons/emotion-icon';\nexport var AttachFile = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(EmotionIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"none\",\n    d: \"M0 0h24v24H0V0z\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5a2.5 2.5 0 015 0v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5a2.5 2.5 0 005 0V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z\"\n  }));\n});\nAttachFile.displayName = 'AttachFile';\nexport var AttachFileDimensions = {\n  height: 24,\n  width: 24\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { EmotionIconBase } from '@emotion-icons/emotion-icon';\nexport var Send = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(EmotionIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    width: 24,\n    height: 24,\n    fill: \"none\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M3 5.51v3.71c0 .46.31.86.76.97L11 12l-7.24 1.81c-.45.11-.76.51-.76.97v3.71c0 .72.73 1.2 1.39.92l15.42-6.49c.82-.34.82-1.5 0-1.84L4.39 4.58C3.73 4.31 3 4.79 3 5.51z\"\n  }));\n});\nSend.displayName = 'Send';\nexport var SendDimensions = {\n  height: 24,\n  width: 24\n};","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2025)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { assertNever } from \"~lib/util/assertNever\"\nimport { AcceptFileValue } from \"~lib/util/utils\"\n\n/**\n * Configures input props for file upload based on the accept file type.\n * Handles special attributes needed for directory uploads.\n */\nexport const configureFileInputProps = (\n  inputProps: Record<string, unknown>,\n  acceptFile: AcceptFileValue\n): Record<string, unknown> => {\n  // Apply webkitdirectory attribute for directory uploads\n  if (acceptFile === AcceptFileValue.Directory) {\n    return {\n      ...inputProps,\n      webkitdirectory: \"\",\n      multiple: true,\n    }\n  }\n  return inputProps\n}\n\n/**\n * Checks if a file type is allowed based on the accepted extensions.\n */\nexport const isFileTypeAllowed = (\n  file: File,\n  acceptedExtensions?: string[]\n): boolean => {\n  // If no extensions are specified, allow all files\n  if (!acceptedExtensions || acceptedExtensions.length === 0) {\n    return true\n  }\n\n  // Extract the actual file extension (after the last dot)\n  const fileName = file.name.toLowerCase()\n  const lastDotIndex = fileName.lastIndexOf(\".\")\n\n  // If there's no extension, check if empty extension is allowed\n  if (lastDotIndex === -1 || lastDotIndex === fileName.length - 1) {\n    return acceptedExtensions.some(ext => ext === \"\" || ext === \".\")\n  }\n\n  const fileExtension = fileName.substring(lastDotIndex) // includes the dot\n  const fileExtWithoutDot = fileName.substring(lastDotIndex + 1) // without the dot\n\n  // Check if the file extension matches any of the accepted extensions\n  return acceptedExtensions.some(ext => {\n    const extLower = ext.toLowerCase()\n    // Handle both formats: with dot (e.g., \".txt\") and without (e.g., \"txt\")\n    if (extLower.startsWith(\".\")) {\n      return fileExtension === extLower\n    }\n    return fileExtWithoutDot === extLower\n  })\n}\n\n/**\n * Validates a file against allowed types and returns rejection info if invalid.\n * This is the shared validation logic used by both regular uploads and directory uploads.\n */\nexport const validateFileType = (\n  file: File,\n  allowedTypes: string[]\n): { isValid: boolean; errorMessage?: string } => {\n  if (isFileTypeAllowed(file, allowedTypes)) {\n    return { isValid: true }\n  }\n\n  return {\n    isValid: false,\n    errorMessage: `${file.type || \"This type of\"} files are not allowed.`,\n  }\n}\n\n/**\n * Gets a human-readable description for the upload type.\n */\nexport const getUploadDescription = (acceptFile: AcceptFileValue): string => {\n  switch (acceptFile) {\n    case AcceptFileValue.None:\n      return \"a file\"\n    case AcceptFileValue.Single:\n      return \"a file\"\n    case AcceptFileValue.Multiple:\n      return \"files\"\n    case AcceptFileValue.Directory:\n      return \"a directory\"\n    default:\n      assertNever(acceptFile)\n      return \"a file\"\n  }\n}\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2025)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport styled from \"@emotion/styled\"\n\nimport { FileStatus } from \"~lib/components/widgets/FileUploader/UploadFileInfo\"\n\nexport interface StyledChatFileUploadDropzoneProps {\n  height: string\n}\n\n// A transparent dropzone with a minimum height if chat input is short.\n// If chat input grows taller under multi-line, the dropzone will grow with it.\nexport const StyledChatFileUploadDropzone =\n  styled.div<StyledChatFileUploadDropzoneProps>(({ theme, height }) => ({\n    backgroundColor: theme.colors.transparent,\n    position: \"absolute\",\n    left: 0,\n    bottom: 0,\n    minHeight: `max(${theme.sizes.emptyDropdownHeight}, ${height})`,\n    width: \"100%\",\n    zIndex: theme.zIndices.priority,\n  }))\n\nexport interface StyledChatFileUploadDropzoneLabelProps {\n  height: string\n}\n\nexport const StyledChatFileUploadDropzoneLabel =\n  styled.div<StyledChatFileUploadDropzoneLabelProps>(({ theme, height }) => ({\n    border: `${theme.sizes.borderWidth} solid`,\n    borderColor: theme.colors.primary,\n    borderRadius: theme.radii.chatInput,\n    backgroundColor: theme.colors.secondaryBg,\n    color: theme.colors.primary,\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    height: height,\n    width: \"100%\",\n    fontWeight: theme.fontWeights.bold,\n  }))\n\nexport interface StyledFileUploadButtonContainerProps {\n  disabled: boolean\n}\n\nexport const StyledFileUploadButtonContainer =\n  styled.div<StyledFileUploadButtonContainerProps>(({ theme, disabled }) => ({\n    display: \"flex\",\n    alignItems: \"top\",\n    height: \"100%\",\n    // Negative margin to offset the parent border width when we align to top\n    marginTop: `-${theme.sizes.borderWidth}`,\n    cursor: disabled ? \"not-allowed\" : \"auto\",\n  }))\n\nexport interface StyledFileUploadButtonProps {\n  disabled: boolean\n}\n\nexport const StyledFileUploadButton = styled.div<StyledFileUploadButtonProps>(\n  ({ disabled }) => ({\n    pointerEvents: disabled ? \"none\" : \"auto\",\n  })\n)\n\nexport const StyledVerticalDivider = styled.div(({ theme }) => ({\n  // We need to use hard-coded in order to align the divider centered\n  // given the height of chat input and divider.\n  marginTop: \"0.625em\",\n  marginLeft: theme.spacing.sm,\n  height: theme.spacing.xl,\n  width: theme.sizes.borderWidth,\n  backgroundColor: theme.colors.fadedText20,\n}))\n\nexport const StyledChatUploadedFiles = styled.div(({ theme }) => ({\n  left: 0,\n  right: 0,\n  lineHeight: theme.lineHeights.tight,\n  paddingLeft: theme.spacing.sm,\n  paddingRight: theme.spacing.sm,\n  overflowX: \"auto\",\n}))\n\nexport const StyledUploadedChatFileList = styled.div({\n  display: \"flex\",\n})\n\nexport const StyledUploadedChatFileListItem = styled.div({\n  flex: \"0 0 auto\",\n})\n\nexport const StyledChatUploadedFile = styled.div(({ theme }) => ({\n  display: \"flex\",\n  alignItems: \"center\",\n  padding: theme.spacing.sm,\n  gap: theme.spacing.twoXS,\n}))\n\nexport const StyledChatUploadedFileIcon = styled.div(({ theme }) => ({\n  color: theme.colors.fadedText60,\n}))\n\nexport interface StyledChatUploadedFileStatusProps {\n  fileStatus: FileStatus\n}\n\nexport const StyledChatUploadedFileName =\n  styled.div<StyledChatUploadedFileStatusProps>(({ theme, fileStatus }) => ({\n    overflow: \"hidden\",\n    textOverflow: \"ellipsis\",\n    whiteSpace: \"nowrap\",\n    color:\n      fileStatus.type === \"uploaded\"\n        ? theme.colors.bodyText\n        : theme.colors.fadedText60,\n  }))\n\nexport const StyledChatUploadedFileSize = styled.div(({ theme }) => ({\n  marginRight: theme.spacing.md,\n  color: theme.colors.fadedText60,\n}))\n\nexport const StyledChatUploadedFileDeleteButton = styled.small(\n  ({ theme }) => ({\n    display: \"flex\",\n    alignItems: \"center\",\n    maxHeight: theme.sizes.smallElementHeight,\n    color: theme.colors.fadedText60,\n    \"& :hover\": {\n      color: theme.colors.bodyText,\n    },\n  })\n)\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2025)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { memo } from \"react\"\n\nimport { AttachFile } from \"@emotion-icons/material-outlined\"\n\nimport BaseButton, { BaseButtonKind } from \"~lib/components/shared/BaseButton\"\nimport Icon from \"~lib/components/shared/Icon\"\nimport { Placement } from \"~lib/components/shared/Tooltip\"\nimport TooltipIcon from \"~lib/components/shared/TooltipIcon\"\nimport { EmotionTheme } from \"~lib/theme\"\nimport { AcceptFileValue } from \"~lib/util/utils\"\n\nimport {\n  configureFileInputProps,\n  getUploadDescription,\n} from \"./fileUploadUtils\"\nimport {\n  StyledFileUploadButton,\n  StyledFileUploadButtonContainer,\n  StyledVerticalDivider,\n} from \"./styled-components\"\n\nexport interface Props {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- TODO: Replace 'any' with a more specific type.\n  getRootProps: any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- TODO: Replace 'any' with a more specific type.\n  getInputProps: any\n  acceptFile: AcceptFileValue\n  disabled: boolean\n  theme: EmotionTheme\n}\n\nconst ChatFileUploadButton = ({\n  getRootProps,\n  getInputProps,\n  acceptFile,\n  disabled,\n  theme,\n}: Props): React.ReactElement => {\n  const inputProps = configureFileInputProps(getInputProps(), acceptFile)\n\n  return (\n    <StyledFileUploadButtonContainer disabled={disabled}>\n      <StyledFileUploadButton\n        data-testid=\"stChatInputFileUploadButton\"\n        disabled={disabled}\n        {...getRootProps()}\n      >\n        <input {...inputProps} />\n        <TooltipIcon\n          content={`Upload or drag and drop ${getUploadDescription(acceptFile)}`}\n          placement={Placement.TOP}\n          onMouseEnterDelay={500}\n        >\n          <BaseButton kind={BaseButtonKind.MINIMAL} disabled={disabled}>\n            <Icon\n              content={AttachFile}\n              size=\"lg\"\n              color={\n                disabled ? theme.colors.fadedText40 : theme.colors.fadedText60\n              }\n            />\n          </BaseButton>\n        </TooltipIcon>\n      </StyledFileUploadButton>\n      <StyledVerticalDivider />\n    </StyledFileUploadButtonContainer>\n  )\n}\n\nexport default memo(ChatFileUploadButton)\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2025)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { memo } from \"react\"\n\nimport { AcceptFileValue } from \"~lib/util/utils\"\n\nimport {\n  configureFileInputProps,\n  getUploadDescription,\n} from \"./fileUploadUtils\"\nimport {\n  StyledChatFileUploadDropzone,\n  StyledChatFileUploadDropzoneLabel,\n} from \"./styled-components\"\n\nexport interface Props {\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- TODO: Replace 'any' with a more specific type.\n  getRootProps: any\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any -- TODO: Replace 'any' with a more specific type.\n  getInputProps: any\n  acceptFile: AcceptFileValue\n  inputHeight: string\n}\n\nconst ChatFileUploadDropzone = ({\n  getRootProps,\n  getInputProps,\n  acceptFile,\n  inputHeight,\n}: Props): React.ReactElement => {\n  const inputProps = configureFileInputProps(getInputProps(), acceptFile)\n\n  return (\n    <>\n      <StyledChatFileUploadDropzone height={inputHeight} {...getRootProps()}>\n        <input {...inputProps} />\n      </StyledChatFileUploadDropzone>\n      <StyledChatFileUploadDropzoneLabel height={inputHeight}>\n        {`Drag and drop ${getUploadDescription(acceptFile)} here`}\n      </StyledChatFileUploadDropzoneLabel>\n    </>\n  )\n}\n\nexport default memo(ChatFileUploadDropzone)\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2025)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement } from \"react\"\n\nimport Tooltip, { Placement } from \"~lib/components/shared/Tooltip\"\nimport { useEmotionTheme } from \"~lib/hooks/useEmotionTheme\"\n\ninterface Props {\n  children: ReactElement\n  content: string\n}\n\nexport function ChatUploadedFileIconTooltip({\n  children,\n  content,\n}: Props): ReactElement {\n  const theme = useEmotionTheme()\n  return (\n    <Tooltip\n      content={content}\n      placement={Placement.TOP}\n      overrides={{\n        Body: {\n          style: {\n            top: `-${theme.sizes.minElementHeight}`,\n          },\n        },\n      }}\n    >\n      {children}\n    </Tooltip>\n  )\n}\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2025)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { FC, memo } from \"react\"\n\nimport {\n  Clear,\n  ErrorOutline,\n  InsertDriveFile,\n} from \"@emotion-icons/material-outlined\"\n\nimport BaseButton, { BaseButtonKind } from \"~lib/components/shared/BaseButton\"\nimport Icon, { StyledSpinnerIcon } from \"~lib/components/shared/Icon\"\nimport { UploadFileInfo } from \"~lib/components/widgets/FileUploader/UploadFileInfo\"\nimport { useEmotionTheme } from \"~lib/hooks/useEmotionTheme\"\nimport { assertNever } from \"~lib/util/assertNever\"\nimport { FileSize, getSizeDisplay } from \"~lib/util/FileHelper\"\n\nimport { ChatUploadedFileIconTooltip } from \"./ChatUploadedFileIconTooltip\"\nimport {\n  StyledChatUploadedFile,\n  StyledChatUploadedFileDeleteButton,\n  StyledChatUploadedFileIcon,\n  StyledChatUploadedFileName,\n  StyledChatUploadedFileSize,\n} from \"./styled-components\"\n\nexport interface Props {\n  fileInfo: UploadFileInfo\n  onDelete: (id: number) => void\n}\n\nexport interface ChatUploadedFileIconProps {\n  fileInfo: UploadFileInfo\n}\n\nexport const ChatUploadedFileIcon: FC<ChatUploadedFileIconProps> = ({\n  fileInfo,\n}) => {\n  const theme = useEmotionTheme()\n  const { type } = fileInfo.status\n\n  switch (type) {\n    case \"uploading\":\n      return (\n        <StyledSpinnerIcon\n          data-testid=\"stChatInputFileIconSpinner\"\n          size=\"lg\"\n          margin=\"0\"\n          padding=\"0\"\n        />\n      )\n    case \"error\":\n      return (\n        <ChatUploadedFileIconTooltip content={fileInfo.status.errorMessage}>\n          <Icon\n            color={theme.colors.redTextColor}\n            content={ErrorOutline}\n            size=\"lg\"\n          />\n        </ChatUploadedFileIconTooltip>\n      )\n    case \"uploaded\":\n      return <Icon content={InsertDriveFile} size=\"lg\" />\n    default:\n      assertNever(type)\n      return null\n  }\n}\n\nconst ChatUploadedFile = ({\n  fileInfo,\n  onDelete,\n}: Props): React.ReactElement => (\n  <StyledChatUploadedFile\n    className=\"stChatInputFile\"\n    data-testid=\"stChatInputFile\"\n  >\n    <StyledChatUploadedFileIcon>\n      <ChatUploadedFileIcon fileInfo={fileInfo} />\n    </StyledChatUploadedFileIcon>\n    <StyledChatUploadedFileName\n      className=\"stChatInputFileName\"\n      data-testid=\"stChatInputFileName\"\n      title={fileInfo.name}\n      fileStatus={fileInfo.status}\n    >\n      {fileInfo.name}\n    </StyledChatUploadedFileName>\n    <StyledChatUploadedFileSize>\n      {getSizeDisplay(fileInfo.size, FileSize.Byte)}\n    </StyledChatUploadedFileSize>\n    <StyledChatUploadedFileDeleteButton data-testid=\"stChatInputDeleteBtn\">\n      <BaseButton\n        onClick={() => onDelete(fileInfo.id)}\n        kind={BaseButtonKind.MINIMAL}\n      >\n        <Icon content={Clear} size=\"lg\" />\n      </BaseButton>\n    </StyledChatUploadedFileDeleteButton>\n  </StyledChatUploadedFile>\n)\n\nexport default memo(ChatUploadedFile)\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2025)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { memo, ReactElement } from \"react\"\n\nimport { UploadFileInfo } from \"~lib/components/widgets/FileUploader/UploadFileInfo\"\n\nimport ChatUploadedFile from \"./ChatUploadedFile\"\nimport {\n  StyledChatUploadedFiles,\n  StyledUploadedChatFileList,\n  StyledUploadedChatFileListItem,\n} from \"./styled-components\"\n\nexport interface Props {\n  items: UploadFileInfo[]\n  onDelete: (id: number) => void\n}\n\nconst ChatUploadedFiles = ({ items, onDelete }: Props): ReactElement => (\n  <StyledChatUploadedFiles data-testid=\"stChatUploadedFiles\">\n    <StyledUploadedChatFileList>\n      {items.map(file => (\n        <StyledUploadedChatFileListItem key={file.id}>\n          <ChatUploadedFile fileInfo={file} onDelete={onDelete} />\n        </StyledUploadedChatFileListItem>\n      ))}\n    </StyledUploadedChatFileList>\n  </StyledChatUploadedFiles>\n)\n\nexport default memo(ChatUploadedFiles)\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2025)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport zip from \"lodash/zip\"\nimport { ErrorCode as FileErrorCode, FileRejection } from \"react-dropzone\"\n\nimport {\n  ChatInput as ChatInputProto,\n  FileURLs as FileURLsProto,\n  IFileURLs,\n} from \"@streamlit/protobuf\"\n\nimport { UploadFileInfo } from \"~lib/components/widgets/FileUploader/UploadFileInfo\"\nimport { FileUploadClient } from \"~lib/FileUploadClient\"\nimport { getRejectedFileInfo } from \"~lib/util/FileHelper\"\n\nimport { validateFileType } from \"./fileUploadUtils\"\n\ninterface CreateDropHandlerParams {\n  acceptMultipleFiles: boolean\n  acceptDirectoryFiles: boolean\n  maxFileSize: number\n  uploadClient: FileUploadClient\n  uploadFile: (fileURLs: FileURLsProto, file: File) => void\n  addFiles: (files: UploadFileInfo[]) => void\n  getNextLocalFileId: () => number\n  deleteExistingFiles: () => void\n  onUploadComplete: () => void\n  element: ChatInputProto\n}\n\n/**\n * Helper function to separate directory files into accepted and rejected based on file type\n */\nconst filterDirectoryFiles = (\n  files: File[],\n  element: ChatInputProto\n): { accepted: File[]; rejected: FileRejection[] } => {\n  const accepted: File[] = []\n  const rejected: FileRejection[] = []\n\n  files.forEach(file => {\n    const validation = validateFileType(file, element.fileType)\n    if (validation.isValid) {\n      accepted.push(file)\n    } else {\n      rejected.push({\n        file,\n        errors: [\n          {\n            code: FileErrorCode.FileInvalidType,\n            message: validation.errorMessage || \"File type not allowed.\",\n          },\n        ],\n      })\n    }\n  })\n\n  return { accepted, rejected }\n}\n\nexport const createDropHandler =\n  ({\n    acceptMultipleFiles,\n    acceptDirectoryFiles,\n    maxFileSize,\n    uploadClient,\n    uploadFile,\n    addFiles,\n    getNextLocalFileId,\n    deleteExistingFiles,\n    onUploadComplete,\n    element,\n  }: CreateDropHandlerParams) =>\n  (acceptedFiles: File[], rejectedFiles: FileRejection[]): void => {\n    // For directory uploads, we need to do our own file type filtering\n    // because webkitdirectory bypasses react-dropzone's normal validation\n    if (acceptDirectoryFiles && acceptedFiles.length > 0) {\n      const { accepted, rejected } = filterDirectoryFiles(\n        acceptedFiles,\n        element\n      )\n      acceptedFiles = accepted\n      rejectedFiles = [...rejectedFiles, ...rejected]\n    }\n\n    // If only single file upload is allowed but multiple were dropped/selected,\n    // all files will be rejected by default. In this case, we take the first\n    // valid file into acceptedFiles, and reject the rest.\n    if (\n      !acceptMultipleFiles &&\n      acceptedFiles.length === 0 &&\n      rejectedFiles.length > 1\n    ) {\n      const firstFileIndex = rejectedFiles.findIndex(\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-enum-comparison -- TODO: Fix this\n        file => file.errors?.[0].code === FileErrorCode.TooManyFiles\n      )\n\n      if (firstFileIndex >= 0) {\n        acceptedFiles.push(rejectedFiles[firstFileIndex].file)\n        rejectedFiles.splice(firstFileIndex, 1)\n      }\n    }\n\n    if (!acceptMultipleFiles && acceptedFiles.length > 0) {\n      deleteExistingFiles()\n    }\n\n    uploadClient\n      .fetchFileURLs(acceptedFiles)\n      .then((fileURLsArray: IFileURLs[]) => {\n        zip(fileURLsArray, acceptedFiles).forEach(\n          ([fileURLs, acceptedFile]) => {\n            uploadFile(fileURLs as FileURLsProto, acceptedFile as File)\n          }\n        )\n      })\n      .catch((errorMessage: string) => {\n        addFiles(\n          acceptedFiles.map(f => {\n            return new UploadFileInfo(f.name, f.size, getNextLocalFileId(), {\n              type: \"error\",\n              errorMessage,\n            })\n          })\n        )\n      })\n\n    // Create an UploadFileInfo for each of our rejected files, and add them to\n    // our state.\n    if (rejectedFiles.length > 0) {\n      const rejectedInfos = rejectedFiles.map(rejected =>\n        getRejectedFileInfo(rejected, getNextLocalFileId(), maxFileSize)\n      )\n      addFiles(rejectedInfos)\n    }\n\n    onUploadComplete()\n  }\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2025)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { IFileURLs } from \"@streamlit/protobuf\"\n\nimport { UploadFileInfo } from \"~lib/components/widgets/FileUploader/UploadFileInfo\"\nimport { FileUploadClient } from \"~lib/FileUploadClient\"\nimport { WidgetInfo } from \"~lib/WidgetStateManager\"\n\ninterface CreateUploadFileParams {\n  getNextLocalFileId: () => number\n  addFiles: (files: UploadFileInfo[]) => void\n  updateFile: (id: number, fileInfo: UploadFileInfo) => void\n  uploadClient: FileUploadClient\n  element: WidgetInfo\n  onUploadProgress: (e: ProgressEvent, id: number) => void\n  onUploadComplete: (id: number, fileURLs: IFileURLs) => void\n}\n\nexport const createUploadFileHandler =\n  ({\n    getNextLocalFileId,\n    addFiles,\n    updateFile,\n    uploadClient,\n    element,\n    onUploadProgress,\n    onUploadComplete,\n  }: CreateUploadFileParams) =>\n  (fileURLs: IFileURLs, file: File): void => {\n    // Create an UploadFileInfo for this file and add it to our state.\n    // For directory uploads, prefer the webkitRelativePath so we preserve\n    // the original directory structure in the displayed file name.\n    const fileName = file.webkitRelativePath || file.name\n\n    const abortController = new AbortController()\n    const uploadingFileInfo = new UploadFileInfo(\n      fileName,\n      file.size,\n      getNextLocalFileId(),\n      {\n        type: \"uploading\",\n        abortController,\n        progress: 1,\n      }\n    )\n    addFiles([uploadingFileInfo])\n\n    uploadClient\n      .uploadFile(\n        {\n          formId: \"\", // TODO[kajarnec] fix this probably with uploadFile refactoring\n          ...element,\n        },\n        fileURLs.uploadUrl as string,\n        file,\n        e => onUploadProgress(e, uploadingFileInfo.id),\n        abortController.signal\n      )\n      .then(() => onUploadComplete(uploadingFileInfo.id, fileURLs))\n      .catch(err => {\n        // If this was an abort error, we don't show the user an error -\n        // the cancellation was in response to an action they took.\n        if (!(err instanceof DOMException && err.name === \"AbortError\")) {\n          updateFile(\n            uploadingFileInfo.id,\n            uploadingFileInfo.setStatus({\n              type: \"error\",\n              errorMessage: err ? err.toString() : \"Unknown error\",\n            })\n          )\n        }\n      })\n  }\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2025)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport styled from \"@emotion/styled\"\n\nimport { hasLightBackgroundColor } from \"~lib/theme\"\n\nexport const StyledChatInputContainer = styled.div`\n  border: none;\n  position: relative;\n  display: flex;\n`\n\nexport interface StyledChatInputProps {\n  extended: boolean\n}\n\nexport const StyledChatInput = styled.div<StyledChatInputProps>(\n  ({ theme, extended }) => ({\n    border: `${theme.sizes.borderWidth} solid`,\n    borderColor: theme.colors.widgetBorderColor ?? theme.colors.transparent,\n    borderRadius: theme.radii.chatInput,\n    backgroundColor: theme.colors.secondaryBg,\n    position: \"relative\",\n    flexGrow: 1,\n    display: \"flex\",\n    alignItems: \"center\",\n    paddingLeft: theme.spacing.lg,\n    maxHeight: extended ? \"none\" : theme.sizes.minElementHeight,\n    gap: theme.spacing.sm,\n    overflow: \"hidden\",\n\n    \":focus-within\": {\n      borderColor: theme.colors.primary,\n    },\n  })\n)\n\ninterface StyledSendIconButtonProps {\n  disabled: boolean\n  extended: boolean\n}\n\nexport const StyledSendIconButton = styled.button<StyledSendIconButtonProps>(\n  ({ theme, disabled, extended }) => {\n    const lightTheme = hasLightBackgroundColor(theme)\n    const [cleanIconColor, dirtyIconColor] = lightTheme\n      ? [theme.colors.gray60, theme.colors.gray80]\n      : [theme.colors.gray80, theme.colors.gray40]\n    return {\n      border: \"none\",\n      backgroundColor: theme.colors.transparent,\n      borderTopRightRadius: extended ? \"0\" : theme.radii.chatInput,\n      borderTopLeftRadius: extended ? theme.radii.default : \"0\",\n      borderBottomRightRadius: theme.radii.chatInput,\n      display: \"inline-flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      lineHeight: theme.lineHeights.none,\n      margin: theme.spacing.none,\n      padding: theme.spacing.sm,\n      color: disabled ? cleanIconColor : dirtyIconColor,\n      pointerEvents: \"auto\",\n      \"&:focus\": {\n        outline: \"none\",\n      },\n      \":focus\": {\n        outline: \"none\",\n      },\n      \"&:focus-visible\": {\n        backgroundColor: lightTheme\n          ? theme.colors.gray10\n          : theme.colors.gray90,\n      },\n      \"&:hover\": {\n        color: theme.colors.primary,\n      },\n      \"&:disabled, &:disabled:hover, &:disabled:active\": {\n        backgroundColor: theme.colors.transparent,\n        borderColor: theme.colors.transparent,\n        color: theme.colors.gray60,\n        cursor: \"not-allowed\",\n      },\n    }\n  }\n)\n\nexport const StyledSendIconButtonContainer = styled.div(({ theme }) => ({\n  display: \"flex\",\n  alignItems: \"flex-end\",\n  height: \"100%\",\n  position: \"absolute\",\n  right: 0,\n  // Negative margin to offset the parent border width when we align button to end\n  marginBottom: `-${theme.sizes.borderWidth}`,\n  pointerEvents: \"none\",\n}))\n\nexport const StyledInputInstructionsContainer = styled.div(({ theme }) => ({\n  position: \"absolute\",\n  bottom: \"0px\",\n  // Calculate the right padding to account for the send icon (iconSizes.xl + 2 * spacing.sm)\n  // and some additional margin between the icon and the text (spacing.sm).\n  right: `calc(${theme.iconSizes.xl} + 2 * ${theme.spacing.sm} + ${theme.spacing.sm})`,\n}))\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2025)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  ChangeEvent,\n  KeyboardEvent,\n  memo,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\"\n\nimport { Send } from \"@emotion-icons/material-rounded\"\nimport { Textarea as UITextArea } from \"baseui/textarea\"\nimport { useDropzone } from \"react-dropzone\"\n\nimport { useWindowDimensionsContext } from \"@streamlit/lib\"\nimport {\n  ChatInput as ChatInputProto,\n  FileUploaderState as FileUploaderStateProto,\n  IChatInputValue,\n  IFileURLs,\n  UploadedFileInfo as UploadedFileInfoProto,\n} from \"@streamlit/protobuf\"\n\nimport Icon from \"~lib/components/shared/Icon\"\nimport InputInstructions from \"~lib/components/shared/InputInstructions/InputInstructions\"\nimport {\n  UploadedStatus,\n  UploadFileInfo,\n} from \"~lib/components/widgets/FileUploader/UploadFileInfo\"\nimport { getAccept } from \"~lib/components/widgets/FileUploader/utils\"\nimport { FileUploadClient } from \"~lib/FileUploadClient\"\nimport { useCalculatedDimensions } from \"~lib/hooks/useCalculatedDimensions\"\nimport { useEmotionTheme } from \"~lib/hooks/useEmotionTheme\"\nimport { useTextInputAutoExpand } from \"~lib/hooks/useTextInputAutoExpand\"\nimport { FileSize, sizeConverter } from \"~lib/util/FileHelper\"\nimport { isEnterKeyPressed } from \"~lib/util/inputUtils\"\nimport {\n  AcceptFileValue,\n  chatInputAcceptFileProtoValueToEnum,\n  isNullOrUndefined,\n} from \"~lib/util/utils\"\nimport { WidgetStateManager } from \"~lib/WidgetStateManager\"\n\nimport ChatFileUploadButton from \"./fileUpload/ChatFileUploadButton\"\nimport ChatFileUploadDropzone from \"./fileUpload/ChatFileUploadDropzone\"\nimport ChatUploadedFiles from \"./fileUpload/ChatUploadedFiles\"\nimport { createDropHandler } from \"./fileUpload/createDropHandler\"\nimport { createUploadFileHandler } from \"./fileUpload/createFileUploadHandler\"\nimport {\n  StyledChatInput,\n  StyledChatInputContainer,\n  StyledInputInstructionsContainer,\n  StyledSendIconButton,\n  StyledSendIconButtonContainer,\n} from \"./styled-components\"\n\nexport interface Props {\n  disabled: boolean\n  element: ChatInputProto\n  widgetMgr: WidgetStateManager\n  uploadClient: FileUploadClient\n  fragmentId?: string\n}\n\nconst updateFile = (\n  id: number,\n  fileInfo: UploadFileInfo,\n  currentFiles: UploadFileInfo[]\n): UploadFileInfo[] => currentFiles.map(f => (f.id === id ? fileInfo : f))\n\nconst getFile = (\n  localFileId: number,\n  currentFiles: UploadFileInfo[]\n): UploadFileInfo | undefined => currentFiles.find(f => f.id === localFileId)\n\nfunction ChatInput({\n  disabled,\n  element,\n  widgetMgr,\n  fragmentId,\n  uploadClient,\n}: Props): React.ReactElement {\n  const theme = useEmotionTheme()\n\n  const { placeholder, maxChars } = element\n\n  const counterRef = useRef(0)\n  const chatInputRef = useRef<HTMLTextAreaElement>(null)\n\n  const { width, elementRef } = useCalculatedDimensions()\n  const { innerWidth, innerHeight } = useWindowDimensionsContext()\n\n  // The value specified by the user via the UI. If the user didn't touch this widget's UI, the default value is used.\n  const [value, setValue] = useState(element.default)\n  const [files, setFiles] = useState<UploadFileInfo[]>([])\n  const [fileDragged, setFileDragged] = useState(false)\n\n  const autoExpand = useTextInputAutoExpand({\n    textareaRef: chatInputRef,\n    dependencies: [placeholder],\n  })\n\n  /**\n   * @returns True if the user-specified state.value has not yet been synced to\n   * the WidgetStateManager.\n   */\n  const dirty = useMemo(() => {\n    if (files.some(f => f.status.type === \"uploading\")) {\n      return false\n    }\n\n    return value !== \"\" || files.length > 0\n  }, [files, value])\n\n  const acceptFile = chatInputAcceptFileProtoValueToEnum(element.acceptFile)\n  const maxFileSize = sizeConverter(\n    element.maxUploadSizeMb,\n    FileSize.Megabyte,\n    FileSize.Byte\n  )\n\n  const addFiles = useCallback(\n    (filesToAdd: UploadFileInfo[]): void =>\n      setFiles(currentFiles => [...currentFiles, ...filesToAdd]),\n    []\n  )\n\n  const deleteFile = useCallback(\n    (fileId: number): void => {\n      setFiles(prevFiles => {\n        const file = getFile(fileId, prevFiles)\n        if (isNullOrUndefined(file)) {\n          return prevFiles\n        }\n\n        if (file.status.type === \"uploading\") {\n          // Cancel request as the file hasn't been uploaded.\n          // However, it may have been received by the server so we'd still\n          // send out a request to delete it.\n          file.status.abortController.abort()\n        }\n\n        if (\n          file.status.type === \"uploaded\" &&\n          file.status.fileUrls.deleteUrl\n        ) {\n          // eslint-disable-next-line @typescript-eslint/no-floating-promises -- TODO: Fix this\n          uploadClient.deleteFile(file.status.fileUrls.deleteUrl)\n        }\n\n        return prevFiles.filter(fileArg => fileArg.id !== fileId)\n      })\n    },\n    [uploadClient]\n  )\n\n  const createChatInputWidgetFilesValue = (): FileUploaderStateProto => {\n    const uploadedFileInfo: UploadedFileInfoProto[] = files\n      .filter(f => f.status.type === \"uploaded\")\n      .map(f => {\n        const { name, size, status } = f\n        const { fileId, fileUrls } = status as UploadedStatus\n        return new UploadedFileInfoProto({\n          fileId,\n          fileUrls,\n          name,\n          size,\n        })\n      })\n\n    return new FileUploaderStateProto({ uploadedFileInfo })\n  }\n\n  const getNextLocalFileId = (): number => {\n    return counterRef.current++\n  }\n\n  const dropHandler = createDropHandler({\n    acceptMultipleFiles:\n      acceptFile === AcceptFileValue.Multiple ||\n      acceptFile === AcceptFileValue.Directory,\n    acceptDirectoryFiles: acceptFile === AcceptFileValue.Directory,\n    maxFileSize: maxFileSize,\n    uploadClient: uploadClient,\n    uploadFile: createUploadFileHandler({\n      getNextLocalFileId,\n      addFiles,\n      updateFile: (id: number, fileInfo: UploadFileInfo) => {\n        setFiles(prevFiles => updateFile(id, fileInfo, prevFiles))\n      },\n      uploadClient,\n      element,\n      onUploadProgress: (e: ProgressEvent, fileId: number) => {\n        setFiles(prevFiles => {\n          const file = getFile(fileId, prevFiles)\n          if (isNullOrUndefined(file) || file.status.type !== \"uploading\") {\n            return prevFiles\n          }\n\n          const newProgress = Math.round((e.loaded * 100) / e.total)\n          if (file.status.progress === newProgress) {\n            return prevFiles\n          }\n\n          return updateFile(\n            fileId,\n            file.setStatus({\n              type: \"uploading\",\n              abortController: file.status.abortController,\n              progress: newProgress,\n            }),\n            prevFiles\n          )\n        })\n      },\n      onUploadComplete: (id: number, fileUrls: IFileURLs) => {\n        setFiles(prevFiles => {\n          const curFile = getFile(id, prevFiles)\n          if (\n            isNullOrUndefined(curFile) ||\n            curFile.status.type !== \"uploading\"\n          ) {\n            // The file may have been canceled right before the upload\n            // completed. In this case, we just bail.\n            return prevFiles\n          }\n\n          return updateFile(\n            curFile.id,\n            curFile.setStatus({\n              type: \"uploaded\",\n              fileId: fileUrls.fileId as string,\n              fileUrls,\n            }),\n            prevFiles\n          )\n        })\n      },\n    }),\n    addFiles,\n    getNextLocalFileId,\n    deleteExistingFiles: () => files.forEach(f => deleteFile(f.id)),\n    onUploadComplete: () => {\n      if (chatInputRef.current) {\n        chatInputRef.current.focus()\n      }\n    },\n    element,\n  })\n\n  const { getRootProps, getInputProps } = useDropzone({\n    onDrop: dropHandler,\n    multiple:\n      acceptFile === AcceptFileValue.Multiple ||\n      acceptFile === AcceptFileValue.Directory,\n    accept: getAccept(element.fileType),\n    maxSize: maxFileSize,\n  })\n\n  const handleSubmit = (): void => {\n    // We want the chat input to always be in focus\n    // even if the user clicks the submit button\n    if (chatInputRef.current) {\n      chatInputRef.current.focus()\n    }\n\n    if (!dirty || disabled) {\n      return\n    }\n\n    const composedValue: IChatInputValue = {\n      data: value,\n      fileUploaderState: createChatInputWidgetFilesValue(),\n    }\n\n    widgetMgr.setChatInputValue(\n      element,\n      composedValue,\n      { fromUi: true },\n      fragmentId\n    )\n    setFiles([])\n    setValue(\"\")\n    autoExpand.clearScrollHeight()\n  }\n\n  const handleKeyDown = (e: KeyboardEvent<HTMLTextAreaElement>): void => {\n    const { metaKey, ctrlKey, shiftKey } = e\n    const shouldSubmit =\n      isEnterKeyPressed(e) && !shiftKey && !ctrlKey && !metaKey\n\n    if (shouldSubmit) {\n      e.preventDefault()\n\n      handleSubmit()\n    }\n  }\n\n  const handleChange = (e: ChangeEvent<HTMLTextAreaElement>): void => {\n    const { value: targetValue } = e.target\n\n    if (maxChars !== 0 && targetValue.length > maxChars) {\n      return\n    }\n\n    setValue(targetValue)\n    autoExpand.updateScrollHeight()\n  }\n\n  useEffect(() => {\n    if (element.setValue) {\n      // We are intentionally setting this to avoid regularly calling this effect.\n      // TODO: Update to match React best practices\n      // eslint-disable-next-line react-hooks/react-compiler\n      element.setValue = false\n      const val = element.value || \"\"\n      setValue(val)\n    }\n  }, [element])\n\n  useEffect(() => {\n    const handleDragEnter = (event: DragEvent): void => {\n      event.preventDefault()\n      event.stopPropagation()\n      if (!fileDragged && event.dataTransfer?.types.includes(\"Files\")) {\n        setFileDragged(true)\n      }\n    }\n\n    const handleDragLeave = (event: DragEvent): void => {\n      event.preventDefault()\n      event.stopPropagation()\n      if (fileDragged) {\n        // This check prevents the dropzone from flickering since the dragleave\n        // event could fire when user is dragging within the window\n        if (\n          (event.clientX <= 0 && event.clientY <= 0) ||\n          (event.clientX >= innerWidth && event.clientY >= innerHeight)\n        ) {\n          setFileDragged(false)\n        }\n      }\n    }\n\n    const handleDrop = (event: DragEvent): void => {\n      event.preventDefault()\n      event.stopPropagation()\n      if (fileDragged) {\n        setFileDragged(false)\n      }\n    }\n\n    window.addEventListener(\"dragover\", handleDragEnter)\n    window.addEventListener(\"drop\", handleDrop)\n    window.addEventListener(\"dragleave\", handleDragLeave)\n\n    return () => {\n      window.removeEventListener(\"dragover\", handleDragEnter)\n      window.removeEventListener(\"drop\", handleDrop)\n      window.removeEventListener(\"dragleave\", handleDragLeave)\n    }\n  }, [fileDragged, innerWidth, innerHeight])\n\n  const showDropzone = acceptFile !== AcceptFileValue.None && fileDragged\n\n  return (\n    <>\n      {acceptFile === AcceptFileValue.None ? null : (\n        <ChatUploadedFiles items={[...files]} onDelete={deleteFile} />\n      )}\n      <StyledChatInputContainer\n        className=\"stChatInput\"\n        data-testid=\"stChatInput\"\n        ref={elementRef}\n      >\n        {showDropzone ? (\n          <ChatFileUploadDropzone\n            getRootProps={getRootProps}\n            getInputProps={getInputProps}\n            acceptFile={acceptFile}\n            inputHeight={autoExpand.height}\n          />\n        ) : (\n          <StyledChatInput extended={autoExpand.isExtended}>\n            {acceptFile === AcceptFileValue.None ? null : (\n              <ChatFileUploadButton\n                getRootProps={getRootProps}\n                getInputProps={getInputProps}\n                acceptFile={acceptFile}\n                disabled={disabled}\n                theme={theme}\n              />\n            )}\n            <UITextArea\n              inputRef={chatInputRef}\n              value={value}\n              placeholder={placeholder}\n              onChange={handleChange}\n              onKeyDown={handleKeyDown}\n              aria-label={placeholder}\n              disabled={disabled}\n              rows={1}\n              overrides={{\n                Root: {\n                  style: {\n                    minHeight: theme.sizes.minElementHeight,\n                    outline: \"none\",\n                    borderLeftWidth: \"0\",\n                    borderRightWidth: \"0\",\n                    borderTopWidth: \"0\",\n                    borderBottomWidth: \"0\",\n                    borderTopLeftRadius: \"0\",\n                    borderTopRightRadius: \"0\",\n                    borderBottomRightRadius: \"0\",\n                    borderBottomLeftRadius: \"0\",\n                  },\n                },\n                Input: {\n                  props: {\n                    \"data-testid\": \"stChatInputTextArea\",\n                  },\n                  style: {\n                    fontWeight: theme.fontWeights.normal,\n                    lineHeight: theme.lineHeights.inputWidget,\n                    \"::placeholder\": {\n                      color: theme.colors.fadedText60,\n                    },\n                    height: autoExpand.height,\n                    maxHeight: autoExpand.maxHeight,\n                    // Baseweb requires long-hand props, short-hand leads to weird bugs & warnings.\n                    paddingLeft: theme.spacing.none,\n                    paddingBottom: theme.spacing.sm,\n                    paddingTop: theme.spacing.sm,\n                    // Calculate the right padding to account for the send icon (iconSizes.xl + 2 * spacing.sm)\n                    // and some additional margin between the icon and the text (spacing.sm).\n                    paddingRight: `calc(${theme.iconSizes.xl} + 2 * ${theme.spacing.sm} + ${theme.spacing.sm})`,\n                  },\n                },\n              }}\n            />\n            {/* Hide the character limit in small widget sizes */}\n            {width > theme.breakpoints.hideWidgetDetails && (\n              <StyledInputInstructionsContainer>\n                <InputInstructions\n                  dirty={dirty}\n                  value={value}\n                  maxLength={maxChars}\n                  type=\"chat\"\n                  // Chat Input are not able to be used in forms\n                  inForm={false}\n                />\n              </StyledInputInstructionsContainer>\n            )}\n            <StyledSendIconButtonContainer>\n              <StyledSendIconButton\n                onClick={handleSubmit}\n                disabled={!dirty || disabled}\n                extended={autoExpand.isExtended}\n                data-testid=\"stChatInputSubmitButton\"\n              >\n                <Icon content={Send} size=\"xl\" color=\"inherit\" />\n              </StyledSendIconButton>\n            </StyledSendIconButtonContainer>\n          </StyledChatInput>\n        )}\n      </StyledChatInputContainer>\n    </>\n  )\n}\n\nexport default memo(ChatInput)\n"],"names":["AttachFile","React.forwardRef","props","ref","attrs","React.createElement","EmotionIconBase","_extends","Send","configureFileInputProps","inputProps","acceptFile","AcceptFileValue","Directory","webkitdirectory","multiple","isFileTypeAllowed","file","acceptedExtensions","length","fileName","name","toLowerCase","lastDotIndex","lastIndexOf","some","ext","fileExtension","substring","fileExtWithoutDot","extLower","startsWith","validateFileType","allowedTypes","isValid","errorMessage","type","getUploadDescription","None","Single","Multiple","assertNever","StyledChatFileUploadDropzone","_styled","target","theme","height","backgroundColor","colors","transparent","position","left","bottom","minHeight","sizes","emptyDropdownHeight","width","zIndex","zIndices","priority","StyledChatFileUploadDropzoneLabel","border","borderWidth","borderColor","primary","borderRadius","radii","chatInput","secondaryBg","color","display","alignItems","justifyContent","fontWeight","fontWeights","bold","StyledFileUploadButtonContainer","disabled","marginTop","cursor","StyledFileUploadButton","pointerEvents","StyledVerticalDivider","marginLeft","spacing","sm","xl","fadedText20","StyledChatUploadedFiles","right","lineHeight","lineHeights","tight","paddingLeft","paddingRight","overflowX","StyledUploadedChatFileList","styles","StyledUploadedChatFileListItem","StyledChatUploadedFile","padding","gap","twoXS","StyledChatUploadedFileIcon","fadedText60","StyledChatUploadedFileName","fileStatus","overflow","textOverflow","whiteSpace","bodyText","StyledChatUploadedFileSize","marginRight","md","StyledChatUploadedFileDeleteButton","maxHeight","smallElementHeight","ChatFileUploadButton","getRootProps","getInputProps","jsxs","jsx","TooltipIcon","Placement","TOP","BaseButton","BaseButtonKind","MINIMAL","Icon","fadedText40","ChatFileUploadButton$1","memo","ChatFileUploadDropzone","inputHeight","Fragment","ChatFileUploadDropzone$1","ChatUploadedFileIconTooltip","children","content","useEmotionTheme","Tooltip","Body","style","top","minElementHeight","ChatUploadedFileIcon","fileInfo","status","StyledSpinnerIcon","redTextColor","ErrorOutline","InsertDriveFile","ChatUploadedFile","onDelete","getSizeDisplay","size","FileSize","Byte","id","Clear","ChatUploadedFile$1","ChatUploadedFiles","items","map","ChatUploadedFiles$1","filterDirectoryFiles","files","element","accepted","rejected","forEach","validation","fileType","push","errors","code","FileErrorCode","FileInvalidType","message","createDropHandler","acceptMultipleFiles","acceptDirectoryFiles","maxFileSize","uploadClient","uploadFile","addFiles","getNextLocalFileId","deleteExistingFiles","onUploadComplete","acceptedFiles","rejectedFiles","firstFileIndex","findIndex","TooManyFiles","splice","fetchFileURLs","then","fileURLsArray","zip","fileURLs","acceptedFile","catch","f","UploadFileInfo","rejectedInfos","getRejectedFileInfo","createUploadFileHandler","updateFile","onUploadProgress","webkitRelativePath","abortController","AbortController","uploadingFileInfo","progress","formId","uploadUrl","e","signal","err","DOMException","setStatus","toString","StyledChatInputContainer","StyledChatInput","extended","widgetBorderColor","flexGrow","lg","StyledSendIconButton","lightTheme","hasLightBackgroundColor","cleanIconColor","dirtyIconColor","gray60","gray80","gray40","borderTopRightRadius","borderTopLeftRadius","default","borderBottomRightRadius","none","margin","outline","gray10","gray90","StyledSendIconButtonContainer","marginBottom","StyledInputInstructionsContainer","iconSizes","currentFiles","getFile","localFileId","find","ChatInput","widgetMgr","fragmentId","placeholder","maxChars","counterRef","useRef","chatInputRef","elementRef","useCalculatedDimensions","innerWidth","innerHeight","useWindowDimensionsContext","value","setValue","useState","setFiles","fileDragged","setFileDragged","autoExpand","useTextInputAutoExpand","textareaRef","dependencies","dirty","useMemo","chatInputAcceptFileProtoValueToEnum","sizeConverter","maxUploadSizeMb","Megabyte","useCallback","filesToAdd","deleteFile","fileId","prevFiles","isNullOrUndefined","abort","fileUrls","deleteUrl","filter","fileArg","createChatInputWidgetFilesValue","uploadedFileInfo","UploadedFileInfoProto","FileUploaderStateProto","current","dropHandler","newProgress","Math","round","loaded","total","curFile","focus","useDropzone","onDrop","accept","getAccept","maxSize","handleSubmit","composedValue","data","fileUploaderState","setChatInputValue","fromUi","clearScrollHeight","handleKeyDown","metaKey","ctrlKey","shiftKey","isEnterKeyPressed","preventDefault","handleChange","targetValue","updateScrollHeight","useEffect","val","handleDragEnter","event","stopPropagation","dataTransfer","types","includes","handleDragLeave","clientX","clientY","handleDrop","window","addEventListener","removeEventListener","showDropzone","isExtended","UITextArea","Root","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","borderBottomLeftRadius","Input","normal","inputWidget","paddingBottom","paddingTop","breakpoints","hideWidgetDetails","InputInstructions","ChatInput_default"],"mappings":"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","x_google_ignoreList":[0,1]}