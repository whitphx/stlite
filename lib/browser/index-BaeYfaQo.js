import{r,E as P,_ as $,c as R,aj as se,bY as ne,D as X,c6 as y,A as m,j as l,aZ as de,a_ as ue,bb as ce,a$ as pe,aJ as me,aX as G}from"./index-WWaTCBU5.js";import{s as be}from"./sprintf-qvvGTkcg.js";import{u as ge}from"./uniqueId-DYPduyeR.js";import{u as fe}from"./FormClearHelper-BpOF9CVb.js";import{I as he}from"./InputInstructions-DL9eZnqn.js";import{I as ye}from"./input-DPxZynan.js";var K=r.forwardRef(function(e,t){var a={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return r.createElement(P,$({iconAttrs:a,iconVerticalAlign:"middle",iconViewBox:"0 0 8 8"},e,{ref:t}),r.createElement("path",{d:"M0 3v2h8V3H0z"}))});K.displayName="Minus";var J=r.forwardRef(function(e,t){var a={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return r.createElement(P,$({iconAttrs:a,iconVerticalAlign:"middle",iconViewBox:"0 0 8 8"},e,{ref:t}),r.createElement("path",{d:"M3 0v3H0v2h3v3h2V5h3V3H5V0H3z"}))});J.displayName="Plus";const we=R("div",{target:"e116k4er3"})(({theme:e})=>({display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"center",height:e.sizes.minElementHeight,borderWidth:e.sizes.borderWidth,borderStyle:"solid",borderColor:e.colors.widgetBorderColor||e.colors.widgetBackgroundColor||e.colors.bgColor,transitionDuration:"200ms",transitionProperty:"border",transitionTimingFunction:"cubic-bezier(0.2, 0.8, 0.4, 1)",borderRadius:e.radii.default,overflow:"hidden","&.focused":{borderColor:e.colors.primary},input:{MozAppearance:"textfield","&::-webkit-inner-spin-button, &::-webkit-outer-spin-button":{WebkitAppearance:"none",margin:e.spacing.none}}}),""),ve=R("div",{target:"e116k4er2"})({name:"76z9jo",styles:"display:flex;flex-direction:row;align-self:stretch"}),Y=R("button",{target:"e116k4er1"})(({theme:e})=>({margin:e.spacing.none,border:"none",height:e.sizes.full,display:"flex",alignItems:"center",width:e.sizes.numberInputControlsWidth,justifyContent:"center",color:e.colors.bodyText,transition:"color 300ms, backgroundColor 300ms",backgroundColor:e.colors.widgetBackgroundColor||e.colors.secondaryBg,"&:hover:enabled, &:focus:enabled":{color:e.colors.white,backgroundColor:e.colors.primary,transition:"none",outline:"none"},"&:active":{outline:"none",border:"none"},"&:last-of-type":{borderTopRightRadius:e.radii.default,borderBottomRightRadius:e.radii.default},"&:disabled":{cursor:"not-allowed",color:e.colors.fadedText40}}),""),xe=R("div",{target:"e116k4er0"})(({theme:e,clearable:t})=>({position:"absolute",marginRight:e.spacing.twoXS,left:0,right:`calc(${e.sizes.numberInputControlsWidth} * 2 + ${t?"1em":"0em"})`}),"");function Ie(e){return m(e)||e===""?void 0:e}const Te=e=>(e.element.dataType===y.DataType.INT?e.widgetMgr.getIntValue(e.element):e.widgetMgr.getDoubleValue(e.element))??e.element.default??null,Z=({step:e,dataType:t})=>e||(t===y.DataType.INT?1:.01),E=({value:e,format:t,step:a,dataType:w})=>{if(m(e))return null;let i=Ie(t);if(m(i)&&X(a)){const c=a.toString();w===y.DataType.FLOAT&&a!==0&&c.includes(".")&&(i=`%0.${c.split(".")[1].length}f`)}if(m(i))return e.toString();try{return be.sprintf(i,e)}catch{return String(e)}},Ce=(e,t,a)=>m(e)?!1:e-t>=a,ke=(e,t,a)=>m(e)?!1:e+t<=a,Re=({disabled:e,element:t,widgetMgr:a,width:w,theme:i,fragmentId:c})=>{var O;const{dataType:S,id:V,formId:p,default:F,format:B}=t,b=t.hasMin?t.min:-1/0,g=t.hasMax?t.max:1/0,[s,q]=r.useState(Z(t)),M=Te({element:t,widgetMgr:a}),[f,v]=r.useState(!1),[n,x]=r.useState(M),[W,I]=r.useState(E({value:M,...t,step:s})),[A,U]=r.useState(!1),j=r.useRef(null),H=r.useRef(ge("number_input_")),T=Ce(n,s,b),C=ke(n,s,g),_=ne({formId:p}),Q=_?a.allowFormEnterToSubmit(p):f,ee=A&&w>i.breakpoints.hideWidgetDetails;r.useEffect(()=>{q(Z({step:t.step,dataType:t.dataType}))},[t.dataType,t.step]);const d=r.useCallback(({value:o,source:u})=>{var h;if(X(o)&&(b>o||o>g))(h=j.current)==null||h.reportValidity();else{const k=o??F??null;switch(S){case y.DataType.INT:a.setIntValue({id:V,formId:p},k,u,c);break;case y.DataType.FLOAT:a.setDoubleValue({id:V,formId:p},k,u,c);break;default:throw new Error("Invalid data type")}v(!1),x(k),I(E({value:k,dataType:S,format:B,step:s}))}},[b,g,j,a,c,s,S,V,p,F,B]),te=r.useCallback(()=>{f&&d({value:n,source:{fromUi:!0}}),U(!1)},[f,n,d]),re=r.useCallback(()=>{U(!0)},[]),L=r.useCallback(()=>{const{value:o}=t;t.setValue=!1,x(o??null),I(E({value:o??null,...t,step:s})),d({value:o??null,source:{fromUi:!1}})},[t,s,d]);r.useEffect(()=>{t.setValue?L():d({value:n,source:{fromUi:!1}})},[]),t.setValue&&L();const D=m(t.default)&&!e,ae=r.useCallback(()=>{const o=t.default??null;x(o),d({value:o,source:{fromUi:!0}})},[t]);fe({element:t,widgetMgr:a,onFormCleared:ae});const oe=o=>{const{value:u}=o.target;if(u==="")v(!0),x(null),I(null);else{let h;t.dataType===y.DataType.INT?h=parseInt(u,10):h=parseFloat(u),v(!0),x(h),I(u)}},z=r.useCallback(()=>{C&&(v(!0),d({value:(n??b)+s,source:{fromUi:!0}}))},[n,b,s,C]),N=r.useCallback(()=>{T&&(v(!0),d({value:(n??g)-s,source:{fromUi:!0}}))},[n,g,s,T]),ie=r.useCallback(o=>{const{key:u}=o;switch(u){case"ArrowUp":o.preventDefault(),z();break;case"ArrowDown":o.preventDefault(),N();break}},[z,N]),le=r.useCallback(o=>{o.key==="Enter"&&(f&&d({value:n,source:{fromUi:!0}}),a.allowFormEnterToSubmit(p)&&a.submitForm(p,c))},[f,n,d,a,p,c]);return l.jsxs("div",{className:"stNumberInput","data-testid":"stNumberInput",style:{width:w},children:[l.jsx(de,{label:t.label,disabled:e,labelVisibility:ue((O=t.labelVisibility)==null?void 0:O.value),htmlFor:H.current,children:t.help&&l.jsx(ce,{children:l.jsx(pe,{content:t.help,placement:me.TOP_RIGHT})})}),l.jsxs(we,{className:A?"focused":"","data-testid":"stNumberInputContainer",children:[l.jsx(ye,{type:"number",inputRef:j,value:W??"",placeholder:t.placeholder,onBlur:te,onFocus:re,onChange:oe,onKeyPress:le,onKeyDown:ie,clearable:D,clearOnEscape:D,disabled:e,"aria-label":t.label,id:H.current,overrides:{ClearIconContainer:{style:{padding:0}},ClearIcon:{props:{overrides:{Svg:{style:{color:i.colors.darkGray,padding:i.spacing.threeXS,height:i.sizes.clearIconSize,width:i.sizes.clearIconSize,":hover":{fill:i.colors.bodyText}}}}}},Input:{props:{"data-testid":"stNumberInputField",step:s,min:b,max:g,type:"number",inputMode:""},style:{lineHeight:i.lineHeights.inputWidget,paddingRight:i.spacing.sm,paddingLeft:i.spacing.sm,paddingBottom:i.spacing.sm,paddingTop:i.spacing.sm}},InputContainer:{style:()=>({borderTopRightRadius:0,borderBottomRightRadius:0})},Root:{style:{borderTopRightRadius:0,borderBottomRightRadius:0,borderLeftWidth:0,borderRightWidth:0,borderTopWidth:0,borderBottomWidth:0,paddingRight:0}}}}),w>i.breakpoints.hideNumberInputControls&&l.jsxs(ve,{children:[l.jsx(Y,{"data-testid":"stNumberInputStepDown",onClick:N,disabled:!T||e,tabIndex:-1,children:l.jsx(G,{content:K,size:"xs",color:T?"inherit":"disabled"})}),l.jsx(Y,{"data-testid":"stNumberInputStepUp",onClick:z,disabled:!C||e,tabIndex:-1,children:l.jsx(G,{content:J,size:"xs",color:C?"inherit":"disabled"})})]})]}),ee&&l.jsx(xe,{clearable:D,children:l.jsx(he,{dirty:f,value:W??"",inForm:_,allowEnterToSubmit:Q})})]})},Se=se(Re);export{Se as default};
