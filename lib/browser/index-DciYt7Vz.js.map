{"version":3,"file":"index-DciYt7Vz.js","sources":["../../../node_modules/@emotion-icons/open-iconic/Video/Video.esm.js","../../../node_modules/@emotion-icons/open-iconic/X/X.esm.js","../../../node_modules/@emotion-icons/material-rounded/SwitchCamera/SwitchCamera.esm.js","../../../streamlit/frontend/lib/src/components/widgets/CameraInput/styled-components.ts","../../../streamlit/frontend/lib/src/components/widgets/CameraInput/CameraInputButton.tsx","../../../streamlit/frontend/lib/src/components/widgets/CameraInput/SwitchFacingModeButton.tsx","../../../node_modules/react-webcam/dist/react-webcam.js","../../../streamlit/frontend/lib/src/components/widgets/CameraInput/WebcamComponent.tsx","../../../streamlit/frontend/lib/src/components/widgets/CameraInput/CameraInput.tsx"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { EmotionIconBase } from '@emotion-icons/emotion-icon';\nexport var Video = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(EmotionIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 8 8\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M.5 1c-.28 0-.5.23-.5.5v4c0 .28.23.5.5.5h5c.28 0 .5-.22.5-.5V4l1 1h1V2H7L6 3V1.5c0-.28-.22-.5-.5-.5h-5z\"\n  }));\n});\nVideo.displayName = 'Video';\nexport var VideoDimensions = {\n  height: 8,\n  width: 8\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { EmotionIconBase } from '@emotion-icons/emotion-icon';\nexport var X = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(EmotionIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 8 8\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M1.41 0L0 1.41l.72.72L2.5 3.94.72 5.72 0 6.41l1.41 1.44.72-.72 1.81-1.81 1.78 1.81.69.72 1.44-1.44-.72-.69-1.81-1.78 1.81-1.81.72-.72L6.41 0l-.69.72L3.94 2.5 2.13.72 1.41 0z\"\n  }));\n});\nX.displayName = 'X';\nexport var XDimensions = {\n  height: 8,\n  width: 8\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { EmotionIconBase } from '@emotion-icons/emotion-icon';\nexport var SwitchCamera = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(EmotionIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"rect\", {\n    width: 24,\n    height: 24,\n    fill: \"none\"\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M20 5h-3.17l-1.24-1.35A1.99 1.99 0 0014.12 3H9.88c-.56 0-1.1.24-1.48.65L7.17 5H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-1.35 8.35l-2.79 2.79c-.32.32-.86.1-.86-.35v-1.75H9v1.75c0 .45-.54.67-.85.35l-2.79-2.79c-.2-.2-.2-.51 0-.71l2.79-2.79a.5.5 0 01.85.36v1.83h6v-1.83c0-.45.54-.67.85-.35l2.79 2.79c.2.19.2.51.01.7z\"\n  }));\n});\nSwitchCamera.displayName = 'SwitchCamera';\nexport var SwitchCameraDimensions = {\n  height: 24,\n  width: 24\n};","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { MouseEvent, ReactNode } from \"react\"\n\nimport styled, { CSSObject } from \"@emotion/styled\"\nimport { transparentize } from \"color2k\"\n\nimport { EmotionTheme } from \"@streamlit/lib/src/theme\"\n\nexport interface CameraInputButtonProps {\n  onClick?: (event: MouseEvent<HTMLButtonElement>) => any\n  disabled?: boolean\n  children: ReactNode\n  progress?: number | null\n}\n\nenum Size {\n  XSMALL = \"xsmall\",\n  SMALL = \"small\",\n  MEDIUM = \"medium\",\n  LARGE = \"large\",\n}\n\nfunction getSizeStyle(size: Size, theme: EmotionTheme): CSSObject {\n  switch (size) {\n    case Size.XSMALL:\n      return {\n        padding: `${theme.spacing.twoXS} ${theme.spacing.sm}`,\n        fontSize: theme.fontSizes.sm,\n      }\n    case Size.SMALL:\n      return {\n        padding: `${theme.spacing.twoXS} ${theme.spacing.md}`,\n      }\n    case Size.LARGE:\n      return {\n        padding: `${theme.spacing.md} ${theme.spacing.md}`,\n      }\n    default:\n      return {\n        padding: `${theme.spacing.xs} ${theme.spacing.md}`,\n      }\n  }\n}\n\ntype RequiredCameraInputButtonProps = Required<CameraInputButtonProps>\n\nexport const StyledCameraInput = styled.div({\n  // This is used to position the \"Switch facing mode\" button\n  // with respect to the webcam block.\n  position: \"relative\",\n  overflow: \"hidden\",\n  width: \"100%\",\n  objectFit: \"contain\",\n})\n\nexport interface StyledBoxProps {\n  width: number\n}\n\nexport const StyledBox = styled.div<StyledBoxProps>(({ theme, width }) => ({\n  backgroundColor: theme.colors.secondaryBg,\n  borderRadius: `${theme.radii.default} ${theme.radii.default} 0 0`,\n  width: \"100%\",\n  height: (width * 9) / 16,\n  display: \"flex\",\n  flexDirection: \"column\",\n  justifyContent: \"center\",\n  alignItems: \"center\",\n}))\n\nexport const StyledDescription = styled.p(({ theme }) => ({\n  marginTop: theme.spacing.sm,\n  textAlign: \"center\",\n}))\n\nexport interface StyledImgProps {\n  opacity: string\n}\n\nexport const StyledImg = styled.img<StyledImgProps>(({ theme, opacity }) => ({\n  borderRadius: `${theme.radii.default} ${theme.radii.default} 0 0`,\n  objectFit: \"contain\",\n  opacity,\n}))\n\nexport const StyledLink = styled.a(({ theme }) => ({\n  color: theme.colors.primary,\n  display: \"block\",\n  textDecoration: \"none\",\n}))\n\nexport const StyledSpan = styled.span({\n  display: \"flex\",\n  alignItems: \"center\",\n})\n\nexport const StyledSwitchFacingModeButton = styled.div(({ theme }) => ({\n  position: \"absolute\",\n  top: theme.spacing.lg,\n  right: theme.spacing.lg,\n  zIndex: theme.zIndices.priority,\n  color: theme.colors.fadedText40,\n  mixBlendMode: \"difference\",\n  opacity: 0.6,\n}))\n\nexport const StyledWebcamWrapper = styled.div({\n  display: \"flex\",\n})\n\nexport const StyledProgressBar = styled.div({\n  height: \"fit-content\",\n  width: \"100%\",\n  position: \"absolute\",\n  bottom: 0,\n})\n\nexport const StyledCameraInputBaseButton =\n  styled.button<RequiredCameraInputButtonProps>(({ theme }) => ({\n    position: \"relative\",\n    display: \"inline-flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    backgroundColor: theme.colors.lightenedBg05,\n    border: `${theme.sizes.borderWidth} solid ${theme.colors.borderColor}`,\n    borderRadius: `0 0 ${theme.radii.default} ${theme.radii.default}`,\n    \"&:hover\": {\n      borderColor: theme.colors.primary,\n      color: theme.colors.primary,\n    },\n    \"&:active\": {\n      color: theme.colors.white,\n      borderColor: theme.colors.primary,\n      backgroundColor: theme.colors.primary,\n    },\n    \"&:focus:not(:active)\": {\n      borderColor: theme.colors.primary,\n      color: theme.colors.primary,\n    },\n    \"&:disabled, &:disabled:hover, &:disabled:active\": {\n      color: theme.colors.fadedText40,\n    },\n    fontWeight: theme.fontWeights.normal,\n    padding: `${theme.spacing.xs} ${theme.spacing.md}`,\n    margin: theme.spacing.none,\n    lineHeight: theme.lineHeights.base,\n    color: \"inherit\",\n    width: \"100%\",\n    userSelect: \"none\",\n    \"&:focus\": {\n      outline: \"none\",\n    },\n    \"&:focus-visible\": {\n      boxShadow: `0 0 0 0.2rem ${transparentize(theme.colors.primary, 0.5)}`,\n    },\n    ...getSizeStyle(Size.MEDIUM, theme),\n  }))\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { MouseEvent, ReactElement, ReactNode } from \"react\"\n\nimport ProgressBar, {\n  Size as ProgressBarSize,\n} from \"@streamlit/lib/src/components/shared/ProgressBar\"\n\nimport {\n  StyledCameraInputBaseButton,\n  StyledProgressBar,\n} from \"./styled-components\"\n\nexport interface CameraInputButtonProps {\n  onClick?: (event: MouseEvent<HTMLButtonElement>) => any\n  disabled?: boolean\n  progress?: number | null\n  children?: ReactNode\n}\n\nfunction CameraInputButton({\n  disabled,\n  onClick,\n  children,\n  progress,\n}: CameraInputButtonProps): ReactElement {\n  return (\n    <StyledCameraInputBaseButton\n      disabled={disabled || false}\n      onClick={onClick || (() => {})}\n      progress={progress || null}\n      data-testid=\"stCameraInputButton\"\n    >\n      {children}\n      {progress && (\n        <StyledProgressBar>\n          <ProgressBar\n            value={progress}\n            size={ProgressBarSize.EXTRASMALL}\n            overrides={{\n              Bar: {\n                style: {\n                  borderTopLeftRadius: 0,\n                  borderTopRightRadius: 0,\n                },\n              },\n              BarProgress: {\n                style: {\n                  borderTopLeftRadius: 0,\n                  borderTopRightRadius: 0,\n                },\n              },\n              BarContainer: {\n                style: {\n                  borderTopLeftRadius: 0,\n                  borderTopRightRadius: 0,\n                },\n              },\n            }}\n          />\n        </StyledProgressBar>\n      )}\n    </StyledCameraInputBaseButton>\n  )\n}\n\nexport default CameraInputButton\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { ReactElement } from \"react\"\n\nimport { SwitchCamera } from \"@emotion-icons/material-rounded\"\n\nimport BaseButton, {\n  BaseButtonKind,\n} from \"@streamlit/lib/src/components/shared/BaseButton\"\nimport Icon from \"@streamlit/lib/src/components/shared/Icon\"\nimport Tooltip, {\n  Placement,\n} from \"@streamlit/lib/src/components/shared/Tooltip\"\nimport themeColors from \"@streamlit/lib/src/theme/emotionBaseTheme/themeColors\"\n\nimport { StyledSwitchFacingModeButton } from \"./styled-components\"\n\nexport enum FacingMode {\n  USER = \"user\",\n  ENVIRONMENT = \"environment\",\n}\n\nexport interface SwitchFacingModeButtonProps {\n  switchFacingMode: () => void\n}\n\nconst SwitchFacingModeButton = ({\n  switchFacingMode,\n}: SwitchFacingModeButtonProps): ReactElement => {\n  return (\n    <StyledSwitchFacingModeButton data-testid=\"stCameraInputSwitchButton\">\n      <Tooltip content=\"Switch camera\" placement={Placement.TOP_RIGHT}>\n        <BaseButton kind={BaseButtonKind.MINIMAL} onClick={switchFacingMode}>\n          <Icon\n            content={SwitchCamera}\n            size=\"twoXL\"\n            color={themeColors.white}\n          />\n        </BaseButton>\n      </Tooltip>\n    </StyledSwitchFacingModeButton>\n  )\n}\n\nexport default SwitchFacingModeButton\n","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Webcam\"] = factory(require(\"react\"));\n\telse\n\t\troot[\"Webcam\"] = factory(root[\"React\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_react__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = \"./src/react-webcam.tsx\");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./src/react-webcam.tsx\":\n/*!******************************!*\\\n  !*** ./src/react-webcam.tsx ***!\n  \\******************************/\n/*! exports provided: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (undefined && undefined.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\n\n// polyfill based on https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n(function polyfillGetUserMedia() {\n    if (typeof window === 'undefined') {\n        return;\n    }\n    // Older browsers might not implement mediaDevices at all, so we set an empty object first\n    if (navigator.mediaDevices === undefined) {\n        navigator.mediaDevices = {};\n    }\n    // Some browsers partially implement mediaDevices. We can't just assign an object\n    // with getUserMedia as it would overwrite existing properties.\n    // Here, we will just add the getUserMedia property if it's missing.\n    if (navigator.mediaDevices.getUserMedia === undefined) {\n        navigator.mediaDevices.getUserMedia = function (constraints) {\n            // First get ahold of the legacy getUserMedia, if present\n            var getUserMedia = navigator.getUserMedia ||\n                navigator.webkitGetUserMedia ||\n                navigator.mozGetUserMedia ||\n                navigator.msGetUserMedia;\n            // Some browsers just don't implement it - return a rejected promise with an error\n            // to keep a consistent interface\n            if (!getUserMedia) {\n                return Promise.reject(new Error(\"getUserMedia is not implemented in this browser\"));\n            }\n            // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n            return new Promise(function (resolve, reject) {\n                getUserMedia.call(navigator, constraints, resolve, reject);\n            });\n        };\n    }\n})();\nfunction hasGetUserMedia() {\n    return !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia);\n}\nvar Webcam = /** @class */ (function (_super) {\n    __extends(Webcam, _super);\n    function Webcam(props) {\n        var _this = _super.call(this, props) || this;\n        _this.canvas = null;\n        _this.ctx = null;\n        _this.requestUserMediaId = 0;\n        _this.unmounted = false;\n        _this.state = {\n            hasUserMedia: false\n        };\n        return _this;\n    }\n    Webcam.prototype.componentDidMount = function () {\n        var _a = this, state = _a.state, props = _a.props;\n        this.unmounted = false;\n        if (!hasGetUserMedia()) {\n            props.onUserMediaError(\"getUserMedia not supported\");\n            return;\n        }\n        if (!state.hasUserMedia) {\n            this.requestUserMedia();\n        }\n        if (props.children && typeof props.children != 'function') {\n            console.warn(\"children must be a function\");\n        }\n    };\n    Webcam.prototype.componentDidUpdate = function (nextProps) {\n        var props = this.props;\n        if (!hasGetUserMedia()) {\n            props.onUserMediaError(\"getUserMedia not supported\");\n            return;\n        }\n        var audioConstraintsChanged = JSON.stringify(nextProps.audioConstraints) !==\n            JSON.stringify(props.audioConstraints);\n        var videoConstraintsChanged = JSON.stringify(nextProps.videoConstraints) !==\n            JSON.stringify(props.videoConstraints);\n        var minScreenshotWidthChanged = nextProps.minScreenshotWidth !== props.minScreenshotWidth;\n        var minScreenshotHeightChanged = nextProps.minScreenshotHeight !== props.minScreenshotHeight;\n        if (videoConstraintsChanged ||\n            minScreenshotWidthChanged ||\n            minScreenshotHeightChanged) {\n            this.canvas = null;\n            this.ctx = null;\n        }\n        if (audioConstraintsChanged || videoConstraintsChanged) {\n            this.stopAndCleanup();\n            this.requestUserMedia();\n        }\n    };\n    Webcam.prototype.componentWillUnmount = function () {\n        this.unmounted = true;\n        this.stopAndCleanup();\n    };\n    Webcam.stopMediaStream = function (stream) {\n        if (stream) {\n            if (stream.getVideoTracks && stream.getAudioTracks) {\n                stream.getVideoTracks().map(function (track) {\n                    stream.removeTrack(track);\n                    track.stop();\n                });\n                stream.getAudioTracks().map(function (track) {\n                    stream.removeTrack(track);\n                    track.stop();\n                });\n            }\n            else {\n                stream.stop();\n            }\n        }\n    };\n    Webcam.prototype.stopAndCleanup = function () {\n        var state = this.state;\n        if (state.hasUserMedia) {\n            Webcam.stopMediaStream(this.stream);\n            if (state.src) {\n                window.URL.revokeObjectURL(state.src);\n            }\n        }\n    };\n    Webcam.prototype.getScreenshot = function (screenshotDimensions) {\n        var _a = this, state = _a.state, props = _a.props;\n        if (!state.hasUserMedia)\n            return null;\n        var canvas = this.getCanvas(screenshotDimensions);\n        return (canvas &&\n            canvas.toDataURL(props.screenshotFormat, props.screenshotQuality));\n    };\n    Webcam.prototype.getCanvas = function (screenshotDimensions) {\n        var _a = this, state = _a.state, props = _a.props;\n        if (!this.video) {\n            return null;\n        }\n        if (!state.hasUserMedia || !this.video.videoHeight)\n            return null;\n        if (!this.ctx) {\n            var canvasWidth = this.video.videoWidth;\n            var canvasHeight = this.video.videoHeight;\n            if (!this.props.forceScreenshotSourceSize) {\n                var aspectRatio = canvasWidth / canvasHeight;\n                canvasWidth = props.minScreenshotWidth || this.video.clientWidth;\n                canvasHeight = canvasWidth / aspectRatio;\n                if (props.minScreenshotHeight &&\n                    canvasHeight < props.minScreenshotHeight) {\n                    canvasHeight = props.minScreenshotHeight;\n                    canvasWidth = canvasHeight * aspectRatio;\n                }\n            }\n            this.canvas = document.createElement(\"canvas\");\n            this.canvas.width = (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.width) || canvasWidth;\n            this.canvas.height = (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.height) || canvasHeight;\n            this.ctx = this.canvas.getContext(\"2d\");\n        }\n        var _b = this, ctx = _b.ctx, canvas = _b.canvas;\n        if (ctx && canvas) {\n            // adjust the height and width of the canvas to the given dimensions\n            canvas.width = (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.width) || canvas.width;\n            canvas.height = (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.height) || canvas.height;\n            // mirror the screenshot\n            if (props.mirrored) {\n                ctx.translate(canvas.width, 0);\n                ctx.scale(-1, 1);\n            }\n            ctx.imageSmoothingEnabled = props.imageSmoothing;\n            ctx.drawImage(this.video, 0, 0, (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.width) || canvas.width, (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.height) || canvas.height);\n            // invert mirroring\n            if (props.mirrored) {\n                ctx.scale(-1, 1);\n                ctx.translate(-canvas.width, 0);\n            }\n        }\n        return canvas;\n    };\n    Webcam.prototype.requestUserMedia = function () {\n        var _this = this;\n        var props = this.props;\n        var sourceSelected = function (audioConstraints, videoConstraints) {\n            var constraints = {\n                video: typeof videoConstraints !== \"undefined\" ? videoConstraints : true\n            };\n            if (props.audio) {\n                constraints.audio =\n                    typeof audioConstraints !== \"undefined\" ? audioConstraints : true;\n            }\n            _this.requestUserMediaId++;\n            var myRequestUserMediaId = _this.requestUserMediaId;\n            navigator.mediaDevices\n                .getUserMedia(constraints)\n                .then(function (stream) {\n                if (_this.unmounted || myRequestUserMediaId !== _this.requestUserMediaId) {\n                    Webcam.stopMediaStream(stream);\n                }\n                else {\n                    _this.handleUserMedia(null, stream);\n                }\n            })\n                .catch(function (e) {\n                _this.handleUserMedia(e);\n            });\n        };\n        if (\"mediaDevices\" in navigator) {\n            sourceSelected(props.audioConstraints, props.videoConstraints);\n        }\n        else {\n            var optionalSource_1 = function (id) { return ({ optional: [{ sourceId: id }] }); };\n            var constraintToSourceId_1 = function (constraint) {\n                var deviceId = constraint.deviceId;\n                if (typeof deviceId === \"string\") {\n                    return deviceId;\n                }\n                if (Array.isArray(deviceId) && deviceId.length > 0) {\n                    return deviceId[0];\n                }\n                if (typeof deviceId === \"object\" && deviceId.ideal) {\n                    return deviceId.ideal;\n                }\n                return null;\n            };\n            // @ts-ignore: deprecated api\n            MediaStreamTrack.getSources(function (sources) {\n                var audioSource = null;\n                var videoSource = null;\n                sources.forEach(function (source) {\n                    if (source.kind === \"audio\") {\n                        audioSource = source.id;\n                    }\n                    else if (source.kind === \"video\") {\n                        videoSource = source.id;\n                    }\n                });\n                var audioSourceId = constraintToSourceId_1(props.audioConstraints);\n                if (audioSourceId) {\n                    audioSource = audioSourceId;\n                }\n                var videoSourceId = constraintToSourceId_1(props.videoConstraints);\n                if (videoSourceId) {\n                    videoSource = videoSourceId;\n                }\n                sourceSelected(optionalSource_1(audioSource), optionalSource_1(videoSource));\n            });\n        }\n    };\n    Webcam.prototype.handleUserMedia = function (err, stream) {\n        var props = this.props;\n        if (err || !stream) {\n            this.setState({ hasUserMedia: false });\n            props.onUserMediaError(err);\n            return;\n        }\n        this.stream = stream;\n        try {\n            if (this.video) {\n                this.video.srcObject = stream;\n            }\n            this.setState({ hasUserMedia: true });\n        }\n        catch (error) {\n            this.setState({\n                hasUserMedia: true,\n                src: window.URL.createObjectURL(stream)\n            });\n        }\n        props.onUserMedia(stream);\n    };\n    Webcam.prototype.render = function () {\n        var _this = this;\n        var _a = this, state = _a.state, props = _a.props;\n        var audio = props.audio, forceScreenshotSourceSize = props.forceScreenshotSourceSize, onUserMedia = props.onUserMedia, onUserMediaError = props.onUserMediaError, screenshotFormat = props.screenshotFormat, screenshotQuality = props.screenshotQuality, minScreenshotWidth = props.minScreenshotWidth, minScreenshotHeight = props.minScreenshotHeight, audioConstraints = props.audioConstraints, videoConstraints = props.videoConstraints, imageSmoothing = props.imageSmoothing, mirrored = props.mirrored, _b = props.style, style = _b === void 0 ? {} : _b, children = props.children, rest = __rest(props, [\"audio\", \"forceScreenshotSourceSize\", \"onUserMedia\", \"onUserMediaError\", \"screenshotFormat\", \"screenshotQuality\", \"minScreenshotWidth\", \"minScreenshotHeight\", \"audioConstraints\", \"videoConstraints\", \"imageSmoothing\", \"mirrored\", \"style\", \"children\"]);\n        var videoStyle = mirrored ? __assign(__assign({}, style), { transform: (style.transform || \"\") + \" scaleX(-1)\" }) : style;\n        var childrenProps = {\n            getScreenshot: this.getScreenshot.bind(this),\n        };\n        return (react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"](react__WEBPACK_IMPORTED_MODULE_0__[\"Fragment\"], null,\n            react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"](\"video\", __assign({ autoPlay: true, src: state.src, muted: !audio, playsInline: true, ref: function (ref) {\n                    _this.video = ref;\n                }, style: videoStyle }, rest)),\n            children && children(childrenProps)));\n    };\n    Webcam.defaultProps = {\n        audio: false,\n        forceScreenshotSourceSize: false,\n        imageSmoothing: true,\n        mirrored: false,\n        onUserMedia: function () { return undefined; },\n        onUserMediaError: function () { return undefined; },\n        screenshotFormat: \"image/webp\",\n        screenshotQuality: 0.92,\n    };\n    return Webcam;\n}(react__WEBPACK_IMPORTED_MODULE_0__[\"Component\"]));\n/* harmony default export */ __webpack_exports__[\"default\"] = (Webcam);\n\n\n/***/ }),\n\n/***/ \"react\":\n/*!**************************************************************************************!*\\\n  !*** external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\"} ***!\n  \\**************************************************************************************/\n/*! no static exports found */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_react__;\n\n/***/ })\n\n/******/ })[\"default\"];\n});\n//# sourceMappingURL=react-webcam.js.map","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  ReactElement,\n  useCallback,\n  useEffect,\n  useRef,\n  useState,\n} from \"react\"\n\nimport { Video } from \"@emotion-icons/open-iconic\"\nimport { useTheme } from \"@emotion/react\"\nimport { isMobile } from \"react-device-detect\"\nimport Webcam from \"react-webcam\"\n\nimport { debounce } from \"@streamlit/lib/src/util/utils\"\nimport Icon from \"@streamlit/lib/src/components/shared/Icon\"\nimport { EmotionTheme } from \"@streamlit/lib/src/theme\"\nimport themeColors from \"@streamlit/lib/src/theme/emotionBaseTheme/themeColors\"\nimport { CAMERA_PERMISSION_URL } from \"@streamlit/lib/src/urls\"\n\nimport CameraInputButton from \"./CameraInputButton\"\nimport SwitchFacingModeButton, { FacingMode } from \"./SwitchFacingModeButton\"\nimport {\n  StyledBox,\n  StyledCameraInput,\n  StyledDescription,\n  StyledLink,\n} from \"./styled-components\"\n\nexport interface Props {\n  handleCapture: (capturedPhoto: string | null) => void\n  width: number\n  disabled: boolean\n  clearPhotoInProgress: boolean\n  setClearPhotoInProgress: (clearPhotoInProgress: boolean) => void\n  facingMode: FacingMode\n  setFacingMode: () => void\n  // Allow for unit testing\n  testOverride?: WebcamPermission\n}\n\nexport enum WebcamPermission {\n  PENDING = \"pending\",\n  SUCCESS = \"success\",\n  ERROR = \"error\",\n}\n\ninterface AskForCameraPermissionProps {\n  width: number\n}\n\nexport const AskForCameraPermission = ({\n  width,\n}: AskForCameraPermissionProps): ReactElement => {\n  return (\n    <StyledBox width={width}>\n      <Icon size=\"threeXL\" color={themeColors.gray60} content={Video} />\n      <StyledDescription>\n        This app would like to use your camera.\n        <StyledLink\n          href={CAMERA_PERMISSION_URL}\n          rel=\"noopener noreferrer\"\n          target=\"_blank\"\n        >\n          Learn how to allow access.\n        </StyledLink>\n      </StyledDescription>\n    </StyledBox>\n  )\n}\n\nconst WebcamComponent = ({\n  handleCapture,\n  width,\n  disabled,\n  clearPhotoInProgress,\n  setClearPhotoInProgress,\n  facingMode,\n  setFacingMode,\n  testOverride,\n}: Props): ReactElement => {\n  const [webcamPermission, setWebcamPermissionState] = useState(\n    testOverride || WebcamPermission.PENDING\n  )\n  const videoRef = useRef<Webcam>(null)\n\n  const [debouncedWidth, setDebouncedWidth] = useState(width)\n\n  // TODO: Update to match React best practices\n  // eslint-disable-next-line react-compiler/react-compiler\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  const memoizedSetDebouncedCallback = useCallback(\n    debounce(1000, setDebouncedWidth),\n    []\n  )\n\n  useEffect(() => {\n    memoizedSetDebouncedCallback(width)\n  }, [width, memoizedSetDebouncedCallback])\n\n  function capture(): void {\n    if (videoRef.current !== null) {\n      const imageSrc = videoRef.current.getScreenshot()\n      handleCapture(imageSrc)\n    }\n  }\n\n  const theme: EmotionTheme = useTheme()\n\n  return (\n    <StyledCameraInput data-testid=\"stCameraInputWebcamComponent\">\n      {webcamPermission !== WebcamPermission.SUCCESS &&\n      !disabled &&\n      !clearPhotoInProgress ? (\n        <AskForCameraPermission width={debouncedWidth} />\n      ) : (\n        isMobile && <SwitchFacingModeButton switchFacingMode={setFacingMode} />\n      )}\n      <StyledBox\n        data-testid=\"stCameraInputWebcamStyledBox\"\n        hidden={\n          webcamPermission !== WebcamPermission.SUCCESS &&\n          !disabled &&\n          !clearPhotoInProgress\n        }\n        width={debouncedWidth}\n      >\n        {!disabled && (\n          <Webcam\n            audio={false}\n            ref={videoRef}\n            screenshotFormat=\"image/jpeg\"\n            screenshotQuality={1}\n            width={debouncedWidth}\n            // We keep Aspect ratio of container always equal 16 / 9.\n            // The aspect ration of video stream may be different depending on a camera.\n            height={(debouncedWidth * 9) / 16}\n            style={{\n              borderRadius: `${theme.radii.default} ${theme.radii.default} 0 0`,\n            }}\n            onUserMediaError={() => {\n              setWebcamPermissionState(WebcamPermission.ERROR)\n            }}\n            onUserMedia={() => {\n              setWebcamPermissionState(WebcamPermission.SUCCESS)\n              setClearPhotoInProgress(false)\n            }}\n            videoConstraints={{\n              width: { ideal: debouncedWidth },\n              facingMode,\n            }}\n          />\n        )}\n      </StyledBox>\n      <CameraInputButton\n        onClick={capture}\n        disabled={\n          webcamPermission !== WebcamPermission.SUCCESS ||\n          disabled ||\n          clearPhotoInProgress\n        }\n      >\n        Take Photo\n      </CameraInputButton>\n    </StyledCameraInput>\n  )\n}\n\nexport default WebcamComponent\n","/**\n * Copyright (c) Streamlit Inc. (2018-2022) Snowflake Inc. (2022-2024)\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from \"react\"\n\nimport { X } from \"@emotion-icons/open-iconic\"\nimport axios from \"axios\"\nimport isEqual from \"lodash/isEqual\"\n\nimport {\n  CameraInput as CameraInputProto,\n  FileUploaderState as FileUploaderStateProto,\n  FileURLs as FileURLsProto,\n  IFileURLs,\n  UploadedFileInfo as UploadedFileInfoProto,\n} from \"@streamlit/lib/src/proto\"\nimport Icon from \"@streamlit/lib/src/components/shared/Icon\"\nimport { Placement } from \"@streamlit/lib/src/components/shared/Tooltip\"\nimport TooltipIcon from \"@streamlit/lib/src/components/shared/TooltipIcon\"\nimport {\n  StyledWidgetLabelHelp,\n  WidgetLabel,\n} from \"@streamlit/lib/src/components/widgets/BaseWidget\"\nimport { FormClearHelper } from \"@streamlit/lib/src/components/widgets/Form\"\nimport { FileUploadClient } from \"@streamlit/lib/src/FileUploadClient\"\nimport { logError } from \"@streamlit/lib/src/util/log\"\nimport { WidgetStateManager } from \"@streamlit/lib/src/WidgetStateManager\"\nimport {\n  isNullOrUndefined,\n  labelVisibilityProtoValueToEnum,\n} from \"@streamlit/lib/src/util/utils\"\nimport {\n  UploadedStatus,\n  UploadFileInfo,\n  UploadingStatus,\n} from \"@streamlit/lib/src/components/widgets/FileUploader/UploadFileInfo\"\n\nimport CameraInputButton from \"./CameraInputButton\"\nimport { FacingMode } from \"./SwitchFacingModeButton\"\nimport {\n  StyledBox,\n  StyledCameraInput,\n  StyledImg,\n  StyledSpan,\n} from \"./styled-components\"\nimport WebcamComponent, { WebcamPermission } from \"./WebcamComponent\"\n\nexport interface Props {\n  element: CameraInputProto\n  widgetMgr: WidgetStateManager\n  uploadClient: FileUploadClient\n  disabled: boolean\n  width: number\n  fragmentId?: string\n  // Allow for unit testing\n  testOverride?: WebcamPermission\n}\n\ntype FileUploaderStatus =\n  | \"ready\" // FileUploader can upload or delete files\n  | \"updating\" // at least one file is being uploaded or deleted\n\nexport interface State {\n  /**\n   * Base64-encoded image data of the current frame from the camera.\n   */\n  imgSrc: string | null\n\n  shutter: boolean\n\n  minShutterEffectPassed: boolean\n  /**\n   * List of files (snapshots) captured by the user.\n   * Should contain exact one element if the user has taken a snapshot.\n   */\n  files: UploadFileInfo[]\n\n  /**\n   * Represents whether the component is in clear photo mode,\n   * when snapshot removed and new Webcam component is not shown yet.\n   * Time interval between `Clear Photo` button clicked and access to Webcam received again\n   */\n  clearPhotoInProgress: boolean\n\n  /**\n   * User facing mode for mobile devices. If `user`, the camera will be facing the user (front camera).\n   * If `environment`, the camera will be facing the environment (back camera).\n   */\n  facingMode: FacingMode\n}\n\nconst MIN_SHUTTER_EFFECT_TIME_MS = 150\n\nclass CameraInput extends React.PureComponent<Props, State> {\n  private localFileIdCounter = 1\n\n  private RESTORED_FROM_WIDGET_STRING = \"RESTORED_FROM_WIDGET\"\n\n  private readonly formClearHelper = new FormClearHelper()\n\n  public constructor(props: Props) {\n    super(props)\n    this.state = this.initialValue\n  }\n\n  private getProgress = (): number | null | undefined => {\n    if (\n      this.state.files.length > 0 &&\n      this.state.files[this.state.files.length - 1].status.type === \"uploading\"\n    ) {\n      const status = this.state.files[this.state.files.length - 1]\n        .status as UploadingStatus\n      return status.progress\n    }\n    return undefined\n  }\n\n  private setClearPhotoInProgress = (clearPhotoInProgress: boolean): void => {\n    this.setState({ clearPhotoInProgress })\n  }\n\n  private setFacingMode = (): void => {\n    this.setState(prevState => ({\n      facingMode:\n        prevState.facingMode === FacingMode.USER\n          ? FacingMode.ENVIRONMENT\n          : FacingMode.USER,\n    }))\n  }\n\n  private handleCapture = (imgSrc: string | null): Promise<void> => {\n    if (imgSrc === null) {\n      return Promise.resolve()\n    }\n\n    this.setState({\n      imgSrc,\n      shutter: true,\n      minShutterEffectPassed: false,\n    })\n\n    const delay = (t: number): Promise<ReturnType<typeof setTimeout>> =>\n      new Promise(resolve => setTimeout(resolve, t))\n\n    return urltoFile(\n      imgSrc,\n      `camera-input-${new Date().toISOString().replace(/:/g, \"_\")}.jpg`\n    )\n      .then(file =>\n        this.props.uploadClient\n          .fetchFileURLs([file])\n          .then(fileURLsArray => ({ file: file, fileUrls: fileURLsArray[0] }))\n      )\n      .then(({ file, fileUrls }) => this.uploadFile(fileUrls, file))\n      .then(() => delay(MIN_SHUTTER_EFFECT_TIME_MS))\n      .then(() => {\n        this.setState((prevState, _) => {\n          return {\n            imgSrc,\n            shutter: prevState.shutter,\n            minShutterEffectPassed: true,\n          }\n        })\n      })\n      .catch(err => {\n        logError(err)\n      })\n  }\n\n  private removeCapture = (): void => {\n    if (this.state.files.length === 0) {\n      return\n    }\n\n    this.state.files.forEach(file => this.deleteFile(file.id))\n\n    this.setState({\n      imgSrc: null,\n      clearPhotoInProgress: true,\n    })\n  }\n\n  get initialValue(): State {\n    const emptyState = {\n      files: [],\n      imgSrc: null,\n      shutter: false,\n      minShutterEffectPassed: true,\n      clearPhotoInProgress: false,\n      facingMode: FacingMode.USER,\n    }\n    const { widgetMgr, element } = this.props\n\n    const widgetValue = widgetMgr.getFileUploaderStateValue(element)\n\n    if (isNullOrUndefined(widgetValue)) {\n      return emptyState\n    }\n\n    const { uploadedFileInfo } = widgetValue\n    if (isNullOrUndefined(uploadedFileInfo) || uploadedFileInfo.length === 0) {\n      return emptyState\n    }\n\n    return {\n      files: uploadedFileInfo.map(f => {\n        const name = f.name as string\n        const size = f.size as number\n\n        const fileId = f.fileId as string\n        const fileUrls = f.fileUrls as FileURLsProto\n\n        return new UploadFileInfo(name, size, this.nextLocalFileId(), {\n          type: \"uploaded\",\n          fileId,\n          fileUrls,\n        })\n      }),\n      imgSrc:\n        uploadedFileInfo.length === 0 ? \"\" : this.RESTORED_FROM_WIDGET_STRING,\n      shutter: false,\n      minShutterEffectPassed: false,\n      clearPhotoInProgress: false,\n      facingMode: FacingMode.USER,\n    }\n  }\n\n  public componentWillUnmount(): void {\n    this.formClearHelper.disconnect()\n  }\n\n  /**\n   * Return the FileUploader's current status, which is derived from\n   * its state.\n   */\n  public get status(): FileUploaderStatus {\n    const isFileUpdating = (file: UploadFileInfo): boolean =>\n      file.status.type === \"uploading\"\n\n    // If any of our files is Uploading or Deleting, then we're currently\n    // updating.\n    if (this.state.files.some(isFileUpdating)) {\n      return \"updating\"\n    }\n\n    return \"ready\"\n  }\n\n  public componentDidUpdate = (): void => {\n    // If our status is not \"ready\", then we have uploads in progress.\n    // We won't submit a new widgetValue until all uploads have resolved.\n    if (this.status !== \"ready\") {\n      return\n    }\n\n    // If we have had no completed uploads, our widgetValue will be\n    // undefined, and we can early-out of the state update.\n    const newWidgetValue = this.createWidgetValue()\n\n    const { element, widgetMgr, fragmentId } = this.props\n\n    // Maybe send a widgetValue update to the widgetStateManager.\n    const prevWidgetValue = widgetMgr.getFileUploaderStateValue(element)\n    if (!isEqual(newWidgetValue, prevWidgetValue)) {\n      widgetMgr.setFileUploaderStateValue(\n        element,\n        newWidgetValue,\n        {\n          fromUi: true,\n        },\n        fragmentId\n      )\n    }\n  }\n\n  public componentDidMount(): void {\n    const newWidgetValue = this.createWidgetValue()\n    const { element, widgetMgr, fragmentId } = this.props\n\n    // Set the state value on mount, to avoid triggering an extra rerun after\n    // the first rerun.\n    // We use same primitives as in file uploader widget,\n    // since simanticly camera_input is just a special case of file uploader.\n    const prevWidgetValue = widgetMgr.getFileUploaderStateValue(element)\n    if (prevWidgetValue === undefined) {\n      widgetMgr.setFileUploaderStateValue(\n        element,\n        newWidgetValue,\n        {\n          fromUi: false,\n        },\n        fragmentId\n      )\n    }\n  }\n\n  private createWidgetValue(): FileUploaderStateProto {\n    const uploadedFileInfo: UploadedFileInfoProto[] = this.state.files\n      .filter(f => f.status.type === \"uploaded\")\n      .map(f => {\n        const { name, size, status } = f\n        return new UploadedFileInfoProto({\n          fileId: (status as UploadedStatus).fileId,\n          fileUrls: (status as UploadedStatus).fileUrls,\n          name,\n          size,\n        })\n      })\n\n    return new FileUploaderStateProto({ uploadedFileInfo })\n  }\n\n  /**\n   * If we're part of a clear_on_submit form, this will be called when our\n   * form is submitted. Restore our default value and update the WidgetManager.\n   */\n  private onFormCleared = (): void => {\n    this.setState({ files: [] }, () => {\n      const newWidgetValue = this.createWidgetValue()\n      if (isNullOrUndefined(newWidgetValue)) {\n        return\n      }\n\n      this.setState({\n        imgSrc: null,\n      })\n\n      const { widgetMgr, element, fragmentId } = this.props\n      widgetMgr.setFileUploaderStateValue(\n        element,\n        newWidgetValue,\n        { fromUi: true },\n        fragmentId\n      )\n    })\n  }\n\n  public render(): React.ReactNode {\n    const { element, widgetMgr, disabled, width } = this.props\n\n    // Manage our form-clear event handler.\n    this.formClearHelper.manageFormClearListener(\n      widgetMgr,\n      element.formId,\n      this.onFormCleared\n    )\n\n    return (\n      <StyledCameraInput className=\"stCameraInput\" data-testid=\"stCameraInput\">\n        <WidgetLabel\n          label={element.label}\n          disabled={disabled}\n          labelVisibility={labelVisibilityProtoValueToEnum(\n            element.labelVisibility?.value\n          )}\n        >\n          {element.help && (\n            <StyledWidgetLabelHelp>\n              <TooltipIcon\n                content={element.help}\n                placement={Placement.TOP_RIGHT}\n              />\n            </StyledWidgetLabelHelp>\n          )}\n        </WidgetLabel>\n        {this.state.imgSrc ? (\n          <>\n            <StyledBox width={width}>\n              {this.state.imgSrc !== this.RESTORED_FROM_WIDGET_STRING && (\n                <StyledImg\n                  src={this.state.imgSrc}\n                  alt=\"Snapshot\"\n                  opacity={\n                    this.state.shutter || !this.state.minShutterEffectPassed\n                      ? \"50%\"\n                      : \"100%\"\n                  }\n                  width={width}\n                  height={(width * 9) / 16}\n                />\n              )}\n            </StyledBox>\n            <CameraInputButton\n              onClick={this.removeCapture}\n              progress={this.getProgress()}\n              disabled={!!this.getProgress() || disabled}\n            >\n              {this.getProgress() ? (\n                \"Uploading...\"\n              ) : (\n                <StyledSpan>\n                  <Icon content={X} margin=\"0 xs 0 0\" size=\"sm\" /> Clear photo\n                </StyledSpan>\n              )}\n            </CameraInputButton>\n          </>\n        ) : (\n          <WebcamComponent\n            handleCapture={this.handleCapture}\n            width={width}\n            disabled={disabled}\n            clearPhotoInProgress={this.state.clearPhotoInProgress}\n            setClearPhotoInProgress={this.setClearPhotoInProgress}\n            facingMode={this.state.facingMode}\n            setFacingMode={this.setFacingMode}\n            testOverride={this.props.testOverride}\n          />\n        )}\n      </StyledCameraInput>\n    )\n  }\n\n  private nextLocalFileId(): number {\n    return this.localFileIdCounter++\n  }\n\n  /**\n   * Delete the file with the given ID:\n   * - Cancel the file upload if it's in progress\n   * - Remove the fileID from our local state\n   * We don't actually tell the server to delete the file. It will garbage\n   * collect it.\n   */\n  public deleteFile = (fileId: number): void => {\n    const file = this.getFile(fileId)\n    if (isNullOrUndefined(file)) {\n      return\n    }\n\n    if (file.status.type === \"uploading\") {\n      // The file hasn't been uploaded. Let's cancel the request.\n      // However, it may have been received by the server so we'll still\n      // send out a request to delete.\n      file.status.cancelToken.cancel()\n    }\n\n    if (file.status.type === \"uploaded\" && file.status.fileUrls.deleteUrl) {\n      this.props.uploadClient.deleteFile(file.status.fileUrls.deleteUrl)\n    }\n    this.removeFile(fileId)\n  }\n\n  /** Append the given file to `state.files`. */\n  private addFile = (file: UploadFileInfo): void => {\n    this.setState(state => ({ files: [...state.files, file] }))\n  }\n\n  /** Remove the file with the given ID from `state.files`. */\n  private removeFile = (idToRemove: number): void => {\n    this.setState(state => ({\n      files: state.files.filter(file => file.id !== idToRemove),\n    }))\n  }\n\n  /**\n   * Return the file with the given ID, if one exists.\n   */\n  private getFile = (fileId: number): UploadFileInfo | undefined => {\n    return this.state.files.find(file => file.id === fileId)\n  }\n\n  /** Replace the file with the given id in `state.files`. */\n  private updateFile = (curFileId: number, newFile: UploadFileInfo): void => {\n    this.setState(curState => {\n      return {\n        files: curState.files.map(file =>\n          file.id === curFileId ? newFile : file\n        ),\n      }\n    })\n  }\n\n  /**\n   * Called when an upload has completed. Updates the file's status, and\n   * assigns it the new file ID returned from the server.\n   */\n  private onUploadComplete = (\n    localFileId: number,\n    fileUrls: IFileURLs\n  ): void => {\n    this.setState(() => ({\n      shutter: false,\n    }))\n\n    const curFile = this.getFile(localFileId)\n    if (isNullOrUndefined(curFile) || curFile.status.type !== \"uploading\") {\n      // The file may have been canceled right before the upload\n      // completed. In this case, we just bail.\n      return\n    }\n\n    this.updateFile(\n      curFile.id,\n      curFile.setStatus({\n        type: \"uploaded\",\n        fileId: fileUrls.fileId as string,\n        fileUrls,\n      })\n    )\n  }\n\n  /**\n   * Callback for file upload progress. Updates a single file's local `progress`\n   * state.\n   */\n  private onUploadProgress = (event: ProgressEvent, fileId: number): void => {\n    const file = this.getFile(fileId)\n    if (isNullOrUndefined(file) || file.status.type !== \"uploading\") {\n      return\n    }\n\n    const newProgress = Math.round((event.loaded * 100) / event.total)\n    if (file.status.progress === newProgress) {\n      return\n    }\n\n    // Update file.progress\n    this.updateFile(\n      fileId,\n      file.setStatus({\n        type: \"uploading\",\n        cancelToken: file.status.cancelToken,\n        progress: newProgress,\n      })\n    )\n  }\n\n  /**\n   * Clear files and errors, and reset the widget to its READY state.\n   */\n  private reset = (): void => {\n    this.setState({ files: [], imgSrc: null })\n  }\n\n  public uploadFile = (fileURLs: IFileURLs, file: File): void => {\n    // Create an UploadFileInfo for this file and add it to our state.\n    const cancelToken = axios.CancelToken.source()\n    const uploadingFileInfo = new UploadFileInfo(\n      file.name,\n      file.size,\n      this.nextLocalFileId(),\n      {\n        type: \"uploading\",\n        cancelToken,\n        progress: 1,\n      }\n    )\n    this.addFile(uploadingFileInfo)\n\n    this.props.uploadClient\n      .uploadFile(\n        this.props.element,\n        fileURLs.uploadUrl as string,\n        file,\n        e => this.onUploadProgress(e, uploadingFileInfo.id),\n        cancelToken.token\n      )\n      .then(() => this.onUploadComplete(uploadingFileInfo.id, fileURLs))\n      .catch(err => {\n        // If this was a cancel error, we don't show the user an error -\n        // the cancellation was in response to an action they took.\n        if (!axios.isCancel(err)) {\n          this.updateFile(\n            uploadingFileInfo.id,\n            uploadingFileInfo.setStatus({\n              type: \"error\",\n              errorMessage: err ? err.toString() : \"Unknown error\",\n            })\n          )\n        }\n      })\n  }\n}\n\nfunction urltoFile(url: string, filename: string): Promise<File> {\n  return fetch(url)\n    .then(res => res.arrayBuffer())\n    .then(buf => new File([buf], filename, { type: \"image/jpeg\" }))\n}\n\nexport default CameraInput\n"],"names":["Video","React.forwardRef","props","ref","attrs","React.createElement","EmotionIconBase","_extends","X","SwitchCamera","getSizeStyle","size","theme","Size","padding","spacing","twoXS","sm","fontSize","fontSizes","md","xs","StyledCameraInput","target","name","styles","StyledBox","width","backgroundColor","colors","secondaryBg","borderRadius","radii","default","height","display","flexDirection","justifyContent","alignItems","StyledDescription","marginTop","textAlign","StyledImg","opacity","objectFit","StyledLink","color","primary","textDecoration","StyledSpan","StyledSwitchFacingModeButton","position","top","lg","right","zIndex","zIndices","priority","fadedText40","mixBlendMode","StyledProgressBar","StyledCameraInputBaseButton","lightenedBg05","border","sizes","borderWidth","borderColor","white","fontWeight","fontWeights","normal","margin","none","lineHeight","lineHeights","base","userSelect","outline","boxShadow","transparentize","CameraInputButton","disabled","onClick","children","progress","jsx","ProgressBar","ProgressBarSize","EXTRASMALL","Bar","style","borderTopLeftRadius","borderTopRightRadius","BarProgress","BarContainer","FacingMode","USER","ENVIRONMENT","SwitchFacingModeButton","switchFacingMode","Tooltip","Placement","TOP_RIGHT","BaseButton","BaseButtonKind","MINIMAL","Icon","themeColors","root","factory","module","require$$0","this","__WEBPACK_EXTERNAL_MODULE_react__","modules","installedModules","__webpack_require__","moduleId","exports","getter","value","mode","ns","key","object","property","__webpack_exports__","react__WEBPACK_IMPORTED_MODULE_0__","__extends","extendStatics","d","b","p","__","__assign","t","s","i","n","__rest","e","constraints","getUserMedia","resolve","reject","hasGetUserMedia","Webcam","_super","_this","_a","state","nextProps","audioConstraintsChanged","videoConstraintsChanged","minScreenshotWidthChanged","minScreenshotHeightChanged","stream","track","screenshotDimensions","canvas","canvasWidth","canvasHeight","aspectRatio","_b","ctx","sourceSelected","audioConstraints","videoConstraints","myRequestUserMediaId","optionalSource_1","id","constraintToSourceId_1","constraint","deviceId","sources","audioSource","videoSource","source","audioSourceId","videoSourceId","err","audio","mirrored","rest","videoStyle","childrenProps","AskForCameraPermission","jsxs","gray60","CAMERA_PERMISSION_URL","WebcamComponent","handleCapture","clearPhotoInProgress","setClearPhotoInProgress","facingMode","setFacingMode","testOverride","webcamPermission","setWebcamPermissionState","useState","WebcamPermission","videoRef","useRef","debouncedWidth","setDebouncedWidth","memoizedSetDebouncedCallback","useCallback","debounce","useEffect","capture","current","imageSrc","getScreenshot","useTheme","isMobile","ideal","MIN_SHUTTER_EFFECT_TIME_MS","CameraInput","React","PureComponent","constructor","localFileIdCounter","RESTORED_FROM_WIDGET_STRING","formClearHelper","FormClearHelper","getProgress","files","length","status","type","setState","prevState","imgSrc","Promise","shutter","minShutterEffectPassed","delay","setTimeout","urltoFile","Date","toISOString","replace","then","file","uploadClient","fetchFileURLs","fileURLsArray","fileUrls","uploadFile","_","catch","logError","removeCapture","forEach","deleteFile","componentDidUpdate","newWidgetValue","createWidgetValue","element","widgetMgr","fragmentId","prevWidgetValue","getFileUploaderStateValue","isEqual","setFileUploaderStateValue","fromUi","onFormCleared","isNullOrUndefined","fileId","getFile","cancelToken","cancel","deleteUrl","removeFile","addFile","idToRemove","filter","find","updateFile","curFileId","newFile","curState","map","onUploadComplete","localFileId","curFile","setStatus","onUploadProgress","event","newProgress","Math","round","loaded","total","reset","fileURLs","axios","CancelToken","uploadingFileInfo","UploadFileInfo","nextLocalFileId","uploadUrl","token","isCancel","errorMessage","toString","initialValue","emptyState","widgetValue","uploadedFileInfo","f","componentWillUnmount","disconnect","isFileUpdating","some","componentDidMount","undefined","UploadedFileInfoProto","FileUploaderStateProto","render","manageFormClearListener","formId","WidgetLabel","label","labelVisibilityProtoValueToEnum","labelVisibility","help","StyledWidgetLabelHelp","TooltipIcon","Fragment","url","filename","fetch","res","arrayBuffer","buf","File"],"mappings":"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","x_google_ignoreList":[0,1,2,6]}